"use strict";var Ni=Object.create;var vr=Object.defineProperty;var Vi=Object.getOwnPropertyDescriptor;var Hi=Object.getOwnPropertyNames;var Gi=Object.getPrototypeOf,Yi=Object.prototype.hasOwnProperty;var Mt=(a,n)=>()=>(a&&(n=a(a=0)),n);var Cn=(a,n)=>()=>(n||a((n={exports:{}}).exports,n),n.exports),vn=(a,n)=>{for(var o in n)vr(a,o,{get:n[o],enumerable:!0})},lo=(a,n,o,l)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of Hi(n))!Yi.call(a,i)&&i!==o&&vr(a,i,{get:()=>n[i],enumerable:!(l=Vi(n,i))||l.enumerable});return a};var xe=(a,n,o)=>(o=a!=null?Ni(Gi(a)):{},lo(n||!a||!a.__esModule?vr(o,"default",{value:a,enumerable:!0}):o,a)),Qi=a=>lo(vr({},"__esModule",{value:!0}),a);var fo=Cn((Pr,uo)=>{(function(a,n){typeof Pr=="object"&&typeof uo<"u"?n(Pr):typeof define=="function"&&define.amd?define(["exports"],n):(a=typeof globalThis<"u"?globalThis:a||self,n(a.WebStreamsPolyfill={}))})(Pr,(function(a){"use strict";function n(){}function o(e){return typeof e=="object"&&e!==null||typeof e=="function"}let l=n;function i(e,t){try{Object.defineProperty(e,"name",{value:t,configurable:!0})}catch{}}let p=Promise,b=Promise.prototype.then,w=Promise.reject.bind(p);function d(e){return new p(e)}function f(e){return d(t=>t(e))}function m(e){return w(e)}function E(e,t,r){return b.call(e,t,r)}function A(e,t,r){E(E(e,t,r),void 0,l)}function L(e,t){A(e,t)}function y(e,t){A(e,void 0,t)}function W(e,t,r){return E(e,t,r)}function x(e){E(e,void 0,l)}let k=e=>{if(typeof queueMicrotask=="function")k=queueMicrotask;else{let t=f(void 0);k=r=>E(t,r)}return k(e)};function R(e,t,r){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function D(e,t,r){try{return f(R(e,t,r))}catch(s){return m(s)}}let P=16384;class v{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){let r=this._back,s=r;r._elements.length===P-1&&(s={_elements:[],_next:void 0}),r._elements.push(t),s!==r&&(this._back=s,r._next=s),++this._size}shift(){let t=this._front,r=t,s=this._cursor,c=s+1,u=t._elements,h=u[s];return c===P&&(r=t._next,c=0),--this._size,this._cursor=c,t!==r&&(this._front=r),u[s]=void 0,h}forEach(t){let r=this._cursor,s=this._front,c=s._elements;for(;(r!==c.length||s._next!==void 0)&&!(r===c.length&&(s=s._next,c=s._elements,r=0,c.length===0));)t(c[r]),++r}peek(){let t=this._front,r=this._cursor;return t._elements[r]}}let O=Symbol("[[AbortSteps]]"),We=Symbol("[[ErrorSteps]]"),At=Symbol("[[CancelSteps]]"),zr=Symbol("[[PullSteps]]"),Mr=Symbol("[[ReleaseSteps]]");function Hn(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?jr(e):t._state==="closed"?es(e):Gn(e,t._storedError)}function qr(e,t){let r=e._ownerReadableStream;return me(r,t)}function Re(e){let t=e._ownerReadableStream;t._state==="readable"?Nr(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):ts(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),t._readableStreamController[Mr](),t._reader=void 0,e._ownerReadableStream=void 0}function Jt(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function jr(e){e._closedPromise=d((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function Gn(e,t){jr(e),Nr(e,t)}function es(e){jr(e),Yn(e)}function Nr(e,t){e._closedPromise_reject!==void 0&&(x(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function ts(e,t){Gn(e,t)}function Yn(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let Qn=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},rs=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function ns(e){return typeof e=="object"||typeof e=="function"}function ye(e,t){if(e!==void 0&&!ns(e))throw new TypeError(`${t} is not an object.`)}function ie(e,t){if(typeof e!="function")throw new TypeError(`${t} is not a function.`)}function as(e){return typeof e=="object"&&e!==null||typeof e=="function"}function Kn(e,t){if(!as(e))throw new TypeError(`${t} is not an object.`)}function Te(e,t,r){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function Vr(e,t,r){if(e===void 0)throw new TypeError(`${t} is required in '${r}'.`)}function Hr(e){return Number(e)}function Zn(e){return e===0?0:e}function os(e){return Zn(rs(e))}function Gr(e,t){let s=Number.MAX_SAFE_INTEGER,c=Number(e);if(c=Zn(c),!Qn(c))throw new TypeError(`${t} is not a finite number`);if(c=os(c),c<0||c>s)throw new TypeError(`${t} is outside the accepted range of 0 to ${s}, inclusive`);return!Qn(c)||c===0?0:c}function Yr(e,t){if(!je(e))throw new TypeError(`${t} is not a ReadableStream.`)}function mt(e){return new Fe(e)}function Jn(e,t){e._reader._readRequests.push(t)}function Qr(e,t,r){let c=e._reader._readRequests.shift();r?c._closeSteps():c._chunkSteps(t)}function Xt(e){return e._reader._readRequests.length}function Xn(e){let t=e._reader;return!(t===void 0||!Be(t))}class Fe{constructor(t){if(Te(t,1,"ReadableStreamDefaultReader"),Yr(t,"First parameter"),Ne(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Hn(this,t),this._readRequests=new v}get closed(){return Be(this)?this._closedPromise:m(er("closed"))}cancel(t=void 0){return Be(this)?this._ownerReadableStream===void 0?m(Jt("cancel")):qr(this,t):m(er("cancel"))}read(){if(!Be(this))return m(er("read"));if(this._ownerReadableStream===void 0)return m(Jt("read from"));let t,r,s=d((u,h)=>{t=u,r=h});return xt(this,{_chunkSteps:u=>t({value:u,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:u=>r(u)}),s}releaseLock(){if(!Be(this))throw er("releaseLock");this._ownerReadableStream!==void 0&&ss(this)}}Object.defineProperties(Fe.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),i(Fe.prototype.cancel,"cancel"),i(Fe.prototype.read,"read"),i(Fe.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Fe.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function Be(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof Fe}function xt(e,t){let r=e._ownerReadableStream;r._disturbed=!0,r._state==="closed"?t._closeSteps():r._state==="errored"?t._errorSteps(r._storedError):r._readableStreamController[zr](t)}function ss(e){Re(e);let t=new TypeError("Reader was released");ea(e,t)}function ea(e,t){let r=e._readRequests;e._readRequests=new v,r.forEach(s=>{s._errorSteps(t)})}function er(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let is=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class ta{constructor(t,r){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=r}next(){let t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?W(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){let r=()=>this._returnSteps(t);return this._ongoingPromise?W(this._ongoingPromise,r,r):r()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let t=this._reader,r,s,c=d((h,g)=>{r=h,s=g});return xt(t,{_chunkSteps:h=>{this._ongoingPromise=void 0,k(()=>r({value:h,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,Re(t),r({value:void 0,done:!0})},_errorSteps:h=>{this._ongoingPromise=void 0,this._isFinished=!0,Re(t),s(h)}}),c}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;let r=this._reader;if(!this._preventCancel){let s=qr(r,t);return Re(r),W(s,()=>({value:t,done:!0}))}return Re(r),f({value:t,done:!0})}}let ra={next(){return na(this)?this._asyncIteratorImpl.next():m(aa("next"))},return(e){return na(this)?this._asyncIteratorImpl.return(e):m(aa("return"))}};Object.setPrototypeOf(ra,is);function ls(e,t){let r=mt(e),s=new ta(r,t),c=Object.create(ra);return c._asyncIteratorImpl=s,c}function na(e){if(!o(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof ta}catch{return!1}}function aa(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let oa=Number.isNaN||function(e){return e!==e};var Kr,Zr,Jr;function It(e){return e.slice()}function sa(e,t,r,s,c){new Uint8Array(e).set(new Uint8Array(r,s,c),t)}let $e=e=>(typeof e.transfer=="function"?$e=t=>t.transfer():typeof structuredClone=="function"?$e=t=>structuredClone(t,{transfer:[t]}):$e=t=>t,$e(e)),Ue=e=>(typeof e.detached=="boolean"?Ue=t=>t.detached:Ue=t=>t.byteLength===0,Ue(e));function ia(e,t,r){if(e.slice)return e.slice(t,r);let s=r-t,c=new ArrayBuffer(s);return sa(c,0,e,t,s),c}function tr(e,t){let r=e[t];if(r!=null){if(typeof r!="function")throw new TypeError(`${String(t)} is not a function`);return r}}function cs(e){let t={[Symbol.iterator]:()=>e.iterator},r=(async function*(){return yield*t})(),s=r.next;return{iterator:r,nextMethod:s,done:!1}}let Xr=(Jr=(Kr=Symbol.asyncIterator)!==null&&Kr!==void 0?Kr:(Zr=Symbol.for)===null||Zr===void 0?void 0:Zr.call(Symbol,"Symbol.asyncIterator"))!==null&&Jr!==void 0?Jr:"@@asyncIterator";function la(e,t="sync",r){if(r===void 0)if(t==="async"){if(r=tr(e,Xr),r===void 0){let u=tr(e,Symbol.iterator),h=la(e,"sync",u);return cs(h)}}else r=tr(e,Symbol.iterator);if(r===void 0)throw new TypeError("The object is not iterable");let s=R(r,e,[]);if(!o(s))throw new TypeError("The iterator method must return an object");let c=s.next;return{iterator:s,nextMethod:c,done:!1}}function us(e){let t=R(e.nextMethod,e.iterator,[]);if(!o(t))throw new TypeError("The iterator.next() method must return an object");return t}function fs(e){return!!e.done}function ds(e){return e.value}function hs(e){return!(typeof e!="number"||oa(e)||e<0)}function ca(e){let t=ia(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function en(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function tn(e,t,r){if(!hs(r)||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function ms(e){return e._queue.peek().value}function ze(e){e._queue=new v,e._queueTotalSize=0}function ua(e){return e===DataView}function ps(e){return ua(e.constructor)}function bs(e){return ua(e)?1:e.BYTES_PER_ELEMENT}class Qe{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!rn(this))throw ln("view");return this._view}respond(t){if(!rn(this))throw ln("respond");if(Te(t,1,"respond"),t=Gr(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(Ue(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");or(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!rn(this))throw ln("respondWithNewView");if(Te(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(Ue(t.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");sr(this._associatedReadableByteStreamController,t)}}Object.defineProperties(Qe.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),i(Qe.prototype.respond,"respond"),i(Qe.prototype.respondWithNewView,"respondWithNewView"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Qe.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class Ee{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Ke(this))throw Dt("byobRequest");return sn(this)}get desiredSize(){if(!Ke(this))throw Dt("desiredSize");return Sa(this)}close(){if(!Ke(this))throw Dt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);Ot(this)}enqueue(t){if(!Ke(this))throw Dt("enqueue");if(Te(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`);ar(this,t)}error(t=void 0){if(!Ke(this))throw Dt("error");le(this,t)}[At](t){fa(this),ze(this);let r=this._cancelAlgorithm(t);return nr(this),r}[zr](t){let r=this._controlledReadableByteStream;if(this._queueTotalSize>0){wa(this,t);return}let s=this._autoAllocateChunkSize;if(s!==void 0){let c;try{c=new ArrayBuffer(s)}catch(h){t._errorSteps(h);return}let u={buffer:c,bufferByteLength:s,byteOffset:0,byteLength:s,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(u)}Jn(r,t),Ze(this)}[Mr](){if(this._pendingPullIntos.length>0){let t=this._pendingPullIntos.peek();t.readerType="none",this._pendingPullIntos=new v,this._pendingPullIntos.push(t)}}}Object.defineProperties(Ee.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),i(Ee.prototype.close,"close"),i(Ee.prototype.enqueue,"enqueue"),i(Ee.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Ee.prototype,Symbol.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Ke(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof Ee}function rn(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof Qe}function Ze(e){if(!_s(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let r=e._pullAlgorithm();A(r,()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Ze(e)),null),s=>(le(e,s),null))}function fa(e){an(e),e._pendingPullIntos=new v}function nn(e,t){let r=!1;e._state==="closed"&&(r=!0);let s=da(t);t.readerType==="default"?Qr(e,s,r):Cs(e,s,r)}function da(e){let t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function rr(e,t,r,s){e._queue.push({buffer:t,byteOffset:r,byteLength:s}),e._queueTotalSize+=s}function ha(e,t,r,s){let c;try{c=ia(t,r,r+s)}catch(u){throw le(e,u),u}rr(e,c,0,s)}function ma(e,t){t.bytesFilled>0&&ha(e,t.buffer,t.byteOffset,t.bytesFilled),pt(e)}function pa(e,t){let r=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),s=t.bytesFilled+r,c=r,u=!1,h=s%t.elementSize,g=s-h;g>=t.minimumFill&&(c=g-t.bytesFilled,u=!0);let T=e._queue;for(;c>0;){let S=T.peek(),$=Math.min(c,S.byteLength),C=t.byteOffset+t.bytesFilled;sa(t.buffer,C,S.buffer,S.byteOffset,$),S.byteLength===$?T.shift():(S.byteOffset+=$,S.byteLength-=$),e._queueTotalSize-=$,ba(e,$,t),c-=$}return u}function ba(e,t,r){r.bytesFilled+=t}function ga(e){e._queueTotalSize===0&&e._closeRequested?(nr(e),zt(e._controlledReadableByteStream)):Ze(e)}function an(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function on(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let t=e._pendingPullIntos.peek();pa(e,t)&&(pt(e),nn(e._controlledReadableByteStream,t))}}function gs(e){let t=e._controlledReadableByteStream._reader;for(;t._readRequests.length>0;){if(e._queueTotalSize===0)return;let r=t._readRequests.shift();wa(e,r)}}function ys(e,t,r,s){let c=e._controlledReadableByteStream,u=t.constructor,h=bs(u),{byteOffset:g,byteLength:T}=t,S=r*h,$;try{$=$e(t.buffer)}catch(F){s._errorSteps(F);return}let C={buffer:$,bufferByteLength:$.byteLength,byteOffset:g,byteLength:T,bytesFilled:0,minimumFill:S,elementSize:h,viewConstructor:u,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(C),Ra(c,s);return}if(c._state==="closed"){let F=new u(C.buffer,C.byteOffset,0);s._closeSteps(F);return}if(e._queueTotalSize>0){if(pa(e,C)){let F=da(C);ga(e),s._chunkSteps(F);return}if(e._closeRequested){let F=new TypeError("Insufficient bytes to fill elements in the given buffer");le(e,F),s._errorSteps(F);return}}e._pendingPullIntos.push(C),Ra(c,s),Ze(e)}function ws(e,t){t.readerType==="none"&&pt(e);let r=e._controlledReadableByteStream;if(cn(r))for(;Ta(r)>0;){let s=pt(e);nn(r,s)}}function Ss(e,t,r){if(ba(e,t,r),r.readerType==="none"){ma(e,r),on(e);return}if(r.bytesFilled<r.minimumFill)return;pt(e);let s=r.bytesFilled%r.elementSize;if(s>0){let c=r.byteOffset+r.bytesFilled;ha(e,r.buffer,c-s,s)}r.bytesFilled-=s,nn(e._controlledReadableByteStream,r),on(e)}function ya(e,t){let r=e._pendingPullIntos.peek();an(e),e._controlledReadableByteStream._state==="closed"?ws(e,r):Ss(e,t,r),Ze(e)}function pt(e){return e._pendingPullIntos.shift()}function _s(e){let t=e._controlledReadableByteStream;return t._state!=="readable"||e._closeRequested||!e._started?!1:!!(Xn(t)&&Xt(t)>0||cn(t)&&Ta(t)>0||Sa(e)>0)}function nr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Ot(e){let t=e._controlledReadableByteStream;if(!(e._closeRequested||t._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0){let r=e._pendingPullIntos.peek();if(r.bytesFilled%r.elementSize!==0){let s=new TypeError("Insufficient bytes to fill elements in the given buffer");throw le(e,s),s}}nr(e),zt(t)}}function ar(e,t){let r=e._controlledReadableByteStream;if(e._closeRequested||r._state!=="readable")return;let{buffer:s,byteOffset:c,byteLength:u}=t;if(Ue(s))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");let h=$e(s);if(e._pendingPullIntos.length>0){let g=e._pendingPullIntos.peek();if(Ue(g.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");an(e),g.buffer=$e(g.buffer),g.readerType==="none"&&ma(e,g)}if(Xn(r))if(gs(e),Xt(r)===0)rr(e,h,c,u);else{e._pendingPullIntos.length>0&&pt(e);let g=new Uint8Array(h,c,u);Qr(r,g,!1)}else cn(r)?(rr(e,h,c,u),on(e)):rr(e,h,c,u);Ze(e)}function le(e,t){let r=e._controlledReadableByteStream;r._state==="readable"&&(fa(e),ze(e),nr(e),Ya(r,t))}function wa(e,t){let r=e._queue.shift();e._queueTotalSize-=r.byteLength,ga(e);let s=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);t._chunkSteps(s)}function sn(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),s=Object.create(Qe.prototype);Rs(s,e,r),e._byobRequest=s}return e._byobRequest}function Sa(e){let t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function or(e,t){let r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(t===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=$e(r.buffer),ya(e,t)}function sr(e,t){let r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(t.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let c=t.byteLength;r.buffer=$e(t.buffer),ya(e,c)}function _a(e,t,r,s,c,u,h){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,ze(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=u,t._pullAlgorithm=s,t._cancelAlgorithm=c,t._autoAllocateChunkSize=h,t._pendingPullIntos=new v,e._readableStreamController=t;let g=r();A(f(g),()=>(t._started=!0,Ze(t),null),T=>(le(t,T),null))}function ks(e,t,r){let s=Object.create(Ee.prototype),c,u,h;t.start!==void 0?c=()=>t.start(s):c=()=>{},t.pull!==void 0?u=()=>t.pull(s):u=()=>f(void 0),t.cancel!==void 0?h=T=>t.cancel(T):h=()=>f(void 0);let g=t.autoAllocateChunkSize;if(g===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");_a(e,s,c,u,h,r,g)}function Rs(e,t,r){e._associatedReadableByteStreamController=t,e._view=r}function ln(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Dt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Ts(e,t){ye(e,t);let r=e?.mode;return{mode:r===void 0?void 0:$s(r,`${t} has member 'mode' that`)}}function $s(e,t){if(e=`${e}`,e!=="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function Es(e,t){var r;ye(e,t);let s=(r=e?.min)!==null&&r!==void 0?r:1;return{min:Gr(s,`${t} has member 'min' that`)}}function ka(e){return new Me(e)}function Ra(e,t){e._reader._readIntoRequests.push(t)}function Cs(e,t,r){let c=e._reader._readIntoRequests.shift();r?c._closeSteps(t):c._chunkSteps(t)}function Ta(e){return e._reader._readIntoRequests.length}function cn(e){let t=e._reader;return!(t===void 0||!Je(t))}class Me{constructor(t){if(Te(t,1,"ReadableStreamBYOBReader"),Yr(t,"First parameter"),Ne(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Ke(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Hn(this,t),this._readIntoRequests=new v}get closed(){return Je(this)?this._closedPromise:m(ir("closed"))}cancel(t=void 0){return Je(this)?this._ownerReadableStream===void 0?m(Jt("cancel")):qr(this,t):m(ir("cancel"))}read(t,r={}){if(!Je(this))return m(ir("read"));if(!ArrayBuffer.isView(t))return m(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return m(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return m(new TypeError("view's buffer must have non-zero byteLength"));if(Ue(t.buffer))return m(new TypeError("view's buffer has been detached"));let s;try{s=Es(r,"options")}catch(S){return m(S)}let c=s.min;if(c===0)return m(new TypeError("options.min must be greater than 0"));if(ps(t)){if(c>t.byteLength)return m(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(c>t.length)return m(new RangeError("options.min must be less than or equal to view's length"));if(this._ownerReadableStream===void 0)return m(Jt("read from"));let u,h,g=d((S,$)=>{u=S,h=$});return $a(this,t,c,{_chunkSteps:S=>u({value:S,done:!1}),_closeSteps:S=>u({value:S,done:!0}),_errorSteps:S=>h(S)}),g}releaseLock(){if(!Je(this))throw ir("releaseLock");this._ownerReadableStream!==void 0&&vs(this)}}Object.defineProperties(Me.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),i(Me.prototype.cancel,"cancel"),i(Me.prototype.read,"read"),i(Me.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Me.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Je(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof Me}function $a(e,t,r,s){let c=e._ownerReadableStream;c._disturbed=!0,c._state==="errored"?s._errorSteps(c._storedError):ys(c._readableStreamController,t,r,s)}function vs(e){Re(e);let t=new TypeError("Reader was released");Ea(e,t)}function Ea(e,t){let r=e._readIntoRequests;e._readIntoRequests=new v,r.forEach(s=>{s._errorSteps(t)})}function ir(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Lt(e,t){let{highWaterMark:r}=e;if(r===void 0)return t;if(oa(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function lr(e){let{size:t}=e;return t||(()=>1)}function cr(e,t){ye(e,t);let r=e?.highWaterMark,s=e?.size;return{highWaterMark:r===void 0?void 0:Hr(r),size:s===void 0?void 0:Ps(s,`${t} has member 'size' that`)}}function Ps(e,t){return ie(e,t),r=>Hr(e(r))}function As(e,t){ye(e,t);let r=e?.abort,s=e?.close,c=e?.start,u=e?.type,h=e?.write;return{abort:r===void 0?void 0:xs(r,e,`${t} has member 'abort' that`),close:s===void 0?void 0:Is(s,e,`${t} has member 'close' that`),start:c===void 0?void 0:Os(c,e,`${t} has member 'start' that`),write:h===void 0?void 0:Ds(h,e,`${t} has member 'write' that`),type:u}}function xs(e,t,r){return ie(e,r),s=>D(e,t,[s])}function Is(e,t,r){return ie(e,r),()=>D(e,t,[])}function Os(e,t,r){return ie(e,r),s=>R(e,t,[s])}function Ds(e,t,r){return ie(e,r),(s,c)=>D(e,t,[s,c])}function Ca(e,t){if(!bt(e))throw new TypeError(`${t} is not a WritableStream.`)}function Ls(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let Ws=typeof AbortController=="function";function Fs(){if(Ws)return new AbortController}class qe{constructor(t={},r={}){t===void 0?t=null:Kn(t,"First parameter");let s=cr(r,"Second parameter"),c=As(t,"First parameter");if(Pa(this),c.type!==void 0)throw new RangeError("Invalid type is specified");let h=lr(s),g=Lt(s,1);Zs(this,c,g,h)}get locked(){if(!bt(this))throw mr("locked");return gt(this)}abort(t=void 0){return bt(this)?gt(this)?m(new TypeError("Cannot abort a stream that already has a writer")):ur(this,t):m(mr("abort"))}close(){return bt(this)?gt(this)?m(new TypeError("Cannot close a stream that already has a writer")):we(this)?m(new TypeError("Cannot close an already-closing stream")):Aa(this):m(mr("close"))}getWriter(){if(!bt(this))throw mr("getWriter");return va(this)}}Object.defineProperties(qe.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),i(qe.prototype.abort,"abort"),i(qe.prototype.close,"close"),i(qe.prototype.getWriter,"getWriter"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(qe.prototype,Symbol.toStringTag,{value:"WritableStream",configurable:!0});function va(e){return new Ce(e)}function Bs(e,t,r,s,c=1,u=()=>1){let h=Object.create(qe.prototype);Pa(h);let g=Object.create(yt.prototype);return Wa(h,g,e,t,r,s,c,u),h}function Pa(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new v,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function bt(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof qe}function gt(e){return e._writer!==void 0}function ur(e,t){var r;if(e._state==="closed"||e._state==="errored")return f(void 0);e._writableStreamController._abortReason=t,(r=e._writableStreamController._abortController)===null||r===void 0||r.abort(t);let s=e._state;if(s==="closed"||s==="errored")return f(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let c=!1;s==="erroring"&&(c=!0,t=void 0);let u=d((h,g)=>{e._pendingAbortRequest={_promise:void 0,_resolve:h,_reject:g,_reason:t,_wasAlreadyErroring:c}});return e._pendingAbortRequest._promise=u,c||fn(e,t),u}function Aa(e){let t=e._state;if(t==="closed"||t==="errored")return m(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));let r=d((c,u)=>{let h={_resolve:c,_reject:u};e._closeRequest=h}),s=e._writer;return s!==void 0&&e._backpressure&&t==="writable"&&wn(s),Js(e._writableStreamController),r}function Us(e){return d((r,s)=>{let c={_resolve:r,_reject:s};e._writeRequests.push(c)})}function un(e,t){if(e._state==="writable"){fn(e,t);return}dn(e)}function fn(e,t){let r=e._writableStreamController;e._state="erroring",e._storedError=t;let s=e._writer;s!==void 0&&Ia(s,t),!Ns(e)&&r._started&&dn(e)}function dn(e){e._state="errored",e._writableStreamController[We]();let t=e._storedError;if(e._writeRequests.forEach(c=>{c._reject(t)}),e._writeRequests=new v,e._pendingAbortRequest===void 0){fr(e);return}let r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring){r._reject(t),fr(e);return}let s=e._writableStreamController[O](r._reason);A(s,()=>(r._resolve(),fr(e),null),c=>(r._reject(c),fr(e),null))}function zs(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Ms(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,un(e,t)}function qs(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let r=e._writer;r!==void 0&&za(r)}function js(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),un(e,t)}function we(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function Ns(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function Vs(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Hs(e){e._inFlightWriteRequest=e._writeRequests.shift()}function fr(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;t!==void 0&&gn(t,e._storedError)}function hn(e,t){let r=e._writer;r!==void 0&&t!==e._backpressure&&(t?oi(r):wn(r)),e._backpressure=t}class Ce{constructor(t){if(Te(t,1,"WritableStreamDefaultWriter"),Ca(t,"First parameter"),gt(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;let r=t._state;if(r==="writable")!we(t)&&t._backpressure?br(this):Ma(this),pr(this);else if(r==="erroring")yn(this,t._storedError),pr(this);else if(r==="closed")Ma(this),ni(this);else{let s=t._storedError;yn(this,s),Ua(this,s)}}get closed(){return Xe(this)?this._closedPromise:m(et("closed"))}get desiredSize(){if(!Xe(this))throw et("desiredSize");if(this._ownerWritableStream===void 0)throw Ft("desiredSize");return Ks(this)}get ready(){return Xe(this)?this._readyPromise:m(et("ready"))}abort(t=void 0){return Xe(this)?this._ownerWritableStream===void 0?m(Ft("abort")):Gs(this,t):m(et("abort"))}close(){if(!Xe(this))return m(et("close"));let t=this._ownerWritableStream;return t===void 0?m(Ft("close")):we(t)?m(new TypeError("Cannot close an already-closing stream")):xa(this)}releaseLock(){if(!Xe(this))throw et("releaseLock");this._ownerWritableStream!==void 0&&Oa(this)}write(t=void 0){return Xe(this)?this._ownerWritableStream===void 0?m(Ft("write to")):Da(this,t):m(et("write"))}}Object.defineProperties(Ce.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),i(Ce.prototype.abort,"abort"),i(Ce.prototype.close,"close"),i(Ce.prototype.releaseLock,"releaseLock"),i(Ce.prototype.write,"write"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Ce.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Xe(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof Ce}function Gs(e,t){let r=e._ownerWritableStream;return ur(r,t)}function xa(e){let t=e._ownerWritableStream;return Aa(t)}function Ys(e){let t=e._ownerWritableStream,r=t._state;return we(t)||r==="closed"?f(void 0):r==="errored"?m(t._storedError):xa(e)}function Qs(e,t){e._closedPromiseState==="pending"?gn(e,t):ai(e,t)}function Ia(e,t){e._readyPromiseState==="pending"?qa(e,t):si(e,t)}function Ks(e){let t=e._ownerWritableStream,r=t._state;return r==="errored"||r==="erroring"?null:r==="closed"?0:Fa(t._writableStreamController)}function Oa(e){let t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Ia(e,r),Qs(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function Da(e,t){let r=e._ownerWritableStream,s=r._writableStreamController,c=Xs(s,t);if(r!==e._ownerWritableStream)return m(Ft("write to"));let u=r._state;if(u==="errored")return m(r._storedError);if(we(r)||u==="closed")return m(new TypeError("The stream is closing or closed and cannot be written to"));if(u==="erroring")return m(r._storedError);let h=Us(r);return ei(s,t,c),h}let La={};class yt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!mn(this))throw bn("abortReason");return this._abortReason}get signal(){if(!mn(this))throw bn("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t=void 0){if(!mn(this))throw bn("error");this._controlledWritableStream._state==="writable"&&Ba(this,t)}[O](t){let r=this._abortAlgorithm(t);return dr(this),r}[We](){ze(this)}}Object.defineProperties(yt.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(yt.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function mn(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof yt}function Wa(e,t,r,s,c,u,h,g){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,ze(t),t._abortReason=void 0,t._abortController=Fs(),t._started=!1,t._strategySizeAlgorithm=g,t._strategyHWM=h,t._writeAlgorithm=s,t._closeAlgorithm=c,t._abortAlgorithm=u;let T=pn(t);hn(e,T);let S=r(),$=f(S);A($,()=>(t._started=!0,hr(t),null),C=>(t._started=!0,un(e,C),null))}function Zs(e,t,r,s){let c=Object.create(yt.prototype),u,h,g,T;t.start!==void 0?u=()=>t.start(c):u=()=>{},t.write!==void 0?h=S=>t.write(S,c):h=()=>f(void 0),t.close!==void 0?g=()=>t.close():g=()=>f(void 0),t.abort!==void 0?T=S=>t.abort(S):T=()=>f(void 0),Wa(e,c,u,h,g,T,r,s)}function dr(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Js(e){tn(e,La,0),hr(e)}function Xs(e,t){try{return e._strategySizeAlgorithm(t)}catch(r){return Wt(e,r),1}}function Fa(e){return e._strategyHWM-e._queueTotalSize}function ei(e,t,r){try{tn(e,t,r)}catch(c){Wt(e,c);return}let s=e._controlledWritableStream;if(!we(s)&&s._state==="writable"){let c=pn(e);hn(s,c)}hr(e)}function hr(e){let t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring"){dn(t);return}if(e._queue.length===0)return;let s=ms(e);s===La?ti(e):ri(e,s)}function Wt(e,t){e._controlledWritableStream._state==="writable"&&Ba(e,t)}function ti(e){let t=e._controlledWritableStream;Vs(t),en(e);let r=e._closeAlgorithm();dr(e),A(r,()=>(qs(t),null),s=>(js(t,s),null))}function ri(e,t){let r=e._controlledWritableStream;Hs(r);let s=e._writeAlgorithm(t);A(s,()=>{zs(r);let c=r._state;if(en(e),!we(r)&&c==="writable"){let u=pn(e);hn(r,u)}return hr(e),null},c=>(r._state==="writable"&&dr(e),Ms(r,c),null))}function pn(e){return Fa(e)<=0}function Ba(e,t){let r=e._controlledWritableStream;dr(e),fn(r,t)}function mr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function bn(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function et(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Ft(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function pr(e){e._closedPromise=d((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function Ua(e,t){pr(e),gn(e,t)}function ni(e){pr(e),za(e)}function gn(e,t){e._closedPromise_reject!==void 0&&(x(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function ai(e,t){Ua(e,t)}function za(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function br(e){e._readyPromise=d((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function yn(e,t){br(e),qa(e,t)}function Ma(e){br(e),wn(e)}function qa(e,t){e._readyPromise_reject!==void 0&&(x(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function oi(e){br(e)}function si(e,t){yn(e,t)}function wn(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}function ii(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof global<"u")return global}let Sn=ii();function li(e){if(!(typeof e=="function"||typeof e=="object")||e.name!=="DOMException")return!1;try{return new e,!0}catch{return!1}}function ci(){let e=Sn?.DOMException;return li(e)?e:void 0}function ui(){let e=function(r,s){this.message=r||"",this.name=s||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return i(e,"DOMException"),e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let fi=ci()||ui();function ja(e,t,r,s,c,u){let h=mt(e),g=va(t);e._disturbed=!0;let T=!1,S=f(void 0);return d(($,C)=>{let F;if(u!==void 0){if(F=()=>{let _=u.reason!==void 0?u.reason:new fi("Aborted","AbortError"),I=[];s||I.push(()=>t._state==="writable"?ur(t,_):f(void 0)),c||I.push(()=>e._state==="readable"?me(e,_):f(void 0)),K(()=>Promise.all(I.map(B=>B())),!0,_)},u.aborted){F();return}u.addEventListener("abort",F)}function pe(){return d((_,I)=>{function B(ee){ee?_():E(kt(),B,I)}B(!1)})}function kt(){return T?f(!0):E(g._readyPromise,()=>d((_,I)=>{xt(h,{_chunkSteps:B=>{S=E(Da(g,B),void 0,n),_(!1)},_closeSteps:()=>_(!0),_errorSteps:I})}))}if(Pe(e,h._closedPromise,_=>(s?ce(!0,_):K(()=>ur(t,_),!0,_),null)),Pe(t,g._closedPromise,_=>(c?ce(!0,_):K(()=>me(e,_),!0,_),null)),G(e,h._closedPromise,()=>(r?ce():K(()=>Ys(g)),null)),we(t)||t._state==="closed"){let _=new TypeError("the destination writable stream closed before all data could be piped to it");c?ce(!0,_):K(()=>me(e,_),!0,_)}x(pe());function He(){let _=S;return E(S,()=>_!==S?He():void 0)}function Pe(_,I,B){_._state==="errored"?B(_._storedError):y(I,B)}function G(_,I,B){_._state==="closed"?B():L(I,B)}function K(_,I,B){if(T)return;T=!0,t._state==="writable"&&!we(t)?L(He(),ee):ee();function ee(){return A(_(),()=>Ae(I,B),Rt=>Ae(!0,Rt)),null}}function ce(_,I){T||(T=!0,t._state==="writable"&&!we(t)?L(He(),()=>Ae(_,I)):Ae(_,I))}function Ae(_,I){return Oa(g),Re(h),u!==void 0&&u.removeEventListener("abort",F),_?C(I):$(void 0),null}})}class ve{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!gr(this))throw wr("desiredSize");return _n(this)}close(){if(!gr(this))throw wr("close");if(!St(this))throw new TypeError("The stream is not in a state that permits close");tt(this)}enqueue(t=void 0){if(!gr(this))throw wr("enqueue");if(!St(this))throw new TypeError("The stream is not in a state that permits enqueue");return wt(this,t)}error(t=void 0){if(!gr(this))throw wr("error");he(this,t)}[At](t){ze(this);let r=this._cancelAlgorithm(t);return yr(this),r}[zr](t){let r=this._controlledReadableStream;if(this._queue.length>0){let s=en(this);this._closeRequested&&this._queue.length===0?(yr(this),zt(r)):Bt(this),t._chunkSteps(s)}else Jn(r,t),Bt(this)}[Mr](){}}Object.defineProperties(ve.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),i(ve.prototype.close,"close"),i(ve.prototype.enqueue,"enqueue"),i(ve.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ve.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function gr(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof ve}function Bt(e){if(!Na(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let r=e._pullAlgorithm();A(r,()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Bt(e)),null),s=>(he(e,s),null))}function Na(e){let t=e._controlledReadableStream;return!St(e)||!e._started?!1:!!(Ne(t)&&Xt(t)>0||_n(e)>0)}function yr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function tt(e){if(!St(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(yr(e),zt(t))}function wt(e,t){if(!St(e))return;let r=e._controlledReadableStream;if(Ne(r)&&Xt(r)>0)Qr(r,t,!1);else{let s;try{s=e._strategySizeAlgorithm(t)}catch(c){throw he(e,c),c}try{tn(e,t,s)}catch(c){throw he(e,c),c}}Bt(e)}function he(e,t){let r=e._controlledReadableStream;r._state==="readable"&&(ze(e),yr(e),Ya(r,t))}function _n(e){let t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function di(e){return!Na(e)}function St(e){let t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function Va(e,t,r,s,c,u,h){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,ze(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=h,t._strategyHWM=u,t._pullAlgorithm=s,t._cancelAlgorithm=c,e._readableStreamController=t;let g=r();A(f(g),()=>(t._started=!0,Bt(t),null),T=>(he(t,T),null))}function hi(e,t,r,s){let c=Object.create(ve.prototype),u,h,g;t.start!==void 0?u=()=>t.start(c):u=()=>{},t.pull!==void 0?h=()=>t.pull(c):h=()=>f(void 0),t.cancel!==void 0?g=T=>t.cancel(T):g=()=>f(void 0),Va(e,c,u,h,g,r,s)}function wr(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function mi(e,t){return Ke(e._readableStreamController)?bi(e):pi(e)}function pi(e,t){let r=mt(e),s=!1,c=!1,u=!1,h=!1,g,T,S,$,C,F=d(G=>{C=G});function pe(){return s?(c=!0,f(void 0)):(s=!0,xt(r,{_chunkSteps:K=>{k(()=>{c=!1;let ce=K,Ae=K;u||wt(S._readableStreamController,ce),h||wt($._readableStreamController,Ae),s=!1,c&&pe()})},_closeSteps:()=>{s=!1,u||tt(S._readableStreamController),h||tt($._readableStreamController),(!u||!h)&&C(void 0)},_errorSteps:()=>{s=!1}}),f(void 0))}function kt(G){if(u=!0,g=G,h){let K=It([g,T]),ce=me(e,K);C(ce)}return F}function He(G){if(h=!0,T=G,u){let K=It([g,T]),ce=me(e,K);C(ce)}return F}function Pe(){}return S=Ut(Pe,pe,kt),$=Ut(Pe,pe,He),y(r._closedPromise,G=>(he(S._readableStreamController,G),he($._readableStreamController,G),(!u||!h)&&C(void 0),null)),[S,$]}function bi(e){let t=mt(e),r=!1,s=!1,c=!1,u=!1,h=!1,g,T,S,$,C,F=d(_=>{C=_});function pe(_){y(_._closedPromise,I=>(_!==t||(le(S._readableStreamController,I),le($._readableStreamController,I),(!u||!h)&&C(void 0)),null))}function kt(){Je(t)&&(Re(t),t=mt(e),pe(t)),xt(t,{_chunkSteps:I=>{k(()=>{s=!1,c=!1;let B=I,ee=I;if(!u&&!h)try{ee=ca(I)}catch(Rt){le(S._readableStreamController,Rt),le($._readableStreamController,Rt),C(me(e,Rt));return}u||ar(S._readableStreamController,B),h||ar($._readableStreamController,ee),r=!1,s?Pe():c&&G()})},_closeSteps:()=>{r=!1,u||Ot(S._readableStreamController),h||Ot($._readableStreamController),S._readableStreamController._pendingPullIntos.length>0&&or(S._readableStreamController,0),$._readableStreamController._pendingPullIntos.length>0&&or($._readableStreamController,0),(!u||!h)&&C(void 0)},_errorSteps:()=>{r=!1}})}function He(_,I){Be(t)&&(Re(t),t=ka(e),pe(t));let B=I?$:S,ee=I?S:$;$a(t,_,1,{_chunkSteps:Tt=>{k(()=>{s=!1,c=!1;let $t=I?h:u;if(I?u:h)$t||sr(B._readableStreamController,Tt);else{let io;try{io=ca(Tt)}catch(En){le(B._readableStreamController,En),le(ee._readableStreamController,En),C(me(e,En));return}$t||sr(B._readableStreamController,Tt),ar(ee._readableStreamController,io)}r=!1,s?Pe():c&&G()})},_closeSteps:Tt=>{r=!1;let $t=I?h:u,Cr=I?u:h;$t||Ot(B._readableStreamController),Cr||Ot(ee._readableStreamController),Tt!==void 0&&($t||sr(B._readableStreamController,Tt),!Cr&&ee._readableStreamController._pendingPullIntos.length>0&&or(ee._readableStreamController,0)),(!$t||!Cr)&&C(void 0)},_errorSteps:()=>{r=!1}})}function Pe(){if(r)return s=!0,f(void 0);r=!0;let _=sn(S._readableStreamController);return _===null?kt():He(_._view,!1),f(void 0)}function G(){if(r)return c=!0,f(void 0);r=!0;let _=sn($._readableStreamController);return _===null?kt():He(_._view,!0),f(void 0)}function K(_){if(u=!0,g=_,h){let I=It([g,T]),B=me(e,I);C(B)}return F}function ce(_){if(h=!0,T=_,u){let I=It([g,T]),B=me(e,I);C(B)}return F}function Ae(){}return S=Ga(Ae,Pe,K),$=Ga(Ae,G,ce),pe(t),[S,$]}function gi(e){return o(e)&&typeof e.getReader<"u"}function yi(e){return gi(e)?Si(e.getReader()):wi(e)}function wi(e){let t,r=la(e,"async"),s=n;function c(){let h;try{h=us(r)}catch(T){return m(T)}let g=f(h);return W(g,T=>{if(!o(T))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(fs(T))tt(t._readableStreamController);else{let $=ds(T);wt(t._readableStreamController,$)}})}function u(h){let g=r.iterator,T;try{T=tr(g,"return")}catch(C){return m(C)}if(T===void 0)return f(void 0);let S;try{S=R(T,g,[h])}catch(C){return m(C)}let $=f(S);return W($,C=>{if(!o(C))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})}return t=Ut(s,c,u,0),t}function Si(e){let t,r=n;function s(){let u;try{u=e.read()}catch(h){return m(h)}return W(u,h=>{if(!o(h))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(h.done)tt(t._readableStreamController);else{let g=h.value;wt(t._readableStreamController,g)}})}function c(u){try{return f(e.cancel(u))}catch(h){return m(h)}}return t=Ut(r,s,c,0),t}function _i(e,t){ye(e,t);let r=e,s=r?.autoAllocateChunkSize,c=r?.cancel,u=r?.pull,h=r?.start,g=r?.type;return{autoAllocateChunkSize:s===void 0?void 0:Gr(s,`${t} has member 'autoAllocateChunkSize' that`),cancel:c===void 0?void 0:ki(c,r,`${t} has member 'cancel' that`),pull:u===void 0?void 0:Ri(u,r,`${t} has member 'pull' that`),start:h===void 0?void 0:Ti(h,r,`${t} has member 'start' that`),type:g===void 0?void 0:$i(g,`${t} has member 'type' that`)}}function ki(e,t,r){return ie(e,r),s=>D(e,t,[s])}function Ri(e,t,r){return ie(e,r),s=>D(e,t,[s])}function Ti(e,t,r){return ie(e,r),s=>R(e,t,[s])}function $i(e,t){if(e=`${e}`,e!=="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Ei(e,t){return ye(e,t),{preventCancel:!!e?.preventCancel}}function Ha(e,t){ye(e,t);let r=e?.preventAbort,s=e?.preventCancel,c=e?.preventClose,u=e?.signal;return u!==void 0&&Ci(u,`${t} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!s,preventClose:!!c,signal:u}}function Ci(e,t){if(!Ls(e))throw new TypeError(`${t} is not an AbortSignal.`)}function vi(e,t){ye(e,t);let r=e?.readable;Vr(r,"readable","ReadableWritablePair"),Yr(r,`${t} has member 'readable' that`);let s=e?.writable;return Vr(s,"writable","ReadableWritablePair"),Ca(s,`${t} has member 'writable' that`),{readable:r,writable:s}}class V{constructor(t={},r={}){t===void 0?t=null:Kn(t,"First parameter");let s=cr(r,"Second parameter"),c=_i(t,"First parameter");if(kn(this),c.type==="bytes"){if(s.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let u=Lt(s,0);ks(this,c,u)}else{let u=lr(s),h=Lt(s,1);hi(this,c,h,u)}}get locked(){if(!je(this))throw rt("locked");return Ne(this)}cancel(t=void 0){return je(this)?Ne(this)?m(new TypeError("Cannot cancel a stream that already has a reader")):me(this,t):m(rt("cancel"))}getReader(t=void 0){if(!je(this))throw rt("getReader");return Ts(t,"First parameter").mode===void 0?mt(this):ka(this)}pipeThrough(t,r={}){if(!je(this))throw rt("pipeThrough");Te(t,1,"pipeThrough");let s=vi(t,"First parameter"),c=Ha(r,"Second parameter");if(Ne(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(gt(s.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let u=ja(this,s.writable,c.preventClose,c.preventAbort,c.preventCancel,c.signal);return x(u),s.readable}pipeTo(t,r={}){if(!je(this))return m(rt("pipeTo"));if(t===void 0)return m("Parameter 1 is required in 'pipeTo'.");if(!bt(t))return m(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let s;try{s=Ha(r,"Second parameter")}catch(c){return m(c)}return Ne(this)?m(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):gt(t)?m(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):ja(this,t,s.preventClose,s.preventAbort,s.preventCancel,s.signal)}tee(){if(!je(this))throw rt("tee");let t=mi(this);return It(t)}values(t=void 0){if(!je(this))throw rt("values");let r=Ei(t,"First parameter");return ls(this,r.preventCancel)}[Xr](t){return this.values(t)}static from(t){return yi(t)}}Object.defineProperties(V,{from:{enumerable:!0}}),Object.defineProperties(V.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),i(V.from,"from"),i(V.prototype.cancel,"cancel"),i(V.prototype.getReader,"getReader"),i(V.prototype.pipeThrough,"pipeThrough"),i(V.prototype.pipeTo,"pipeTo"),i(V.prototype.tee,"tee"),i(V.prototype.values,"values"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(V.prototype,Symbol.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(V.prototype,Xr,{value:V.prototype.values,writable:!0,configurable:!0});function Ut(e,t,r,s=1,c=()=>1){let u=Object.create(V.prototype);kn(u);let h=Object.create(ve.prototype);return Va(u,h,e,t,r,s,c),u}function Ga(e,t,r){let s=Object.create(V.prototype);kn(s);let c=Object.create(Ee.prototype);return _a(s,c,e,t,r,0,void 0),s}function kn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function je(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof V}function Ne(e){return e._reader!==void 0}function me(e,t){if(e._disturbed=!0,e._state==="closed")return f(void 0);if(e._state==="errored")return m(e._storedError);zt(e);let r=e._reader;if(r!==void 0&&Je(r)){let c=r._readIntoRequests;r._readIntoRequests=new v,c.forEach(u=>{u._closeSteps(void 0)})}let s=e._readableStreamController[At](t);return W(s,n)}function zt(e){e._state="closed";let t=e._reader;if(t!==void 0&&(Yn(t),Be(t))){let r=t._readRequests;t._readRequests=new v,r.forEach(s=>{s._closeSteps()})}}function Ya(e,t){e._state="errored",e._storedError=t;let r=e._reader;r!==void 0&&(Nr(r,t),Be(r)?ea(r,t):Ea(r,t))}function rt(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Qa(e,t){ye(e,t);let r=e?.highWaterMark;return Vr(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Hr(r)}}let Ka=e=>e.byteLength;i(Ka,"size");class Sr{constructor(t){Te(t,1,"ByteLengthQueuingStrategy"),t=Qa(t,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!Ja(this))throw Za("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!Ja(this))throw Za("size");return Ka}}Object.defineProperties(Sr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Sr.prototype,Symbol.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function Za(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function Ja(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof Sr}let Xa=()=>1;i(Xa,"size");class _r{constructor(t){Te(t,1,"CountQueuingStrategy"),t=Qa(t,"First parameter"),this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!to(this))throw eo("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!to(this))throw eo("size");return Xa}}Object.defineProperties(_r.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(_r.prototype,Symbol.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function eo(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function to(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof _r}function Pi(e,t){ye(e,t);let r=e?.cancel,s=e?.flush,c=e?.readableType,u=e?.start,h=e?.transform,g=e?.writableType;return{cancel:r===void 0?void 0:Oi(r,e,`${t} has member 'cancel' that`),flush:s===void 0?void 0:Ai(s,e,`${t} has member 'flush' that`),readableType:c,start:u===void 0?void 0:xi(u,e,`${t} has member 'start' that`),transform:h===void 0?void 0:Ii(h,e,`${t} has member 'transform' that`),writableType:g}}function Ai(e,t,r){return ie(e,r),s=>D(e,t,[s])}function xi(e,t,r){return ie(e,r),s=>R(e,t,[s])}function Ii(e,t,r){return ie(e,r),(s,c)=>D(e,t,[s,c])}function Oi(e,t,r){return ie(e,r),s=>D(e,t,[s])}class kr{constructor(t={},r={},s={}){t===void 0&&(t=null);let c=cr(r,"Second parameter"),u=cr(s,"Third parameter"),h=Pi(t,"First parameter");if(h.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(h.writableType!==void 0)throw new RangeError("Invalid writableType specified");let g=Lt(u,0),T=lr(u),S=Lt(c,1),$=lr(c),C,F=d(pe=>{C=pe});Di(this,F,S,$,g,T),Wi(this,h),h.start!==void 0?C(h.start(this._transformStreamController)):C(void 0)}get readable(){if(!ro(this))throw so("readable");return this._readable}get writable(){if(!ro(this))throw so("writable");return this._writable}}Object.defineProperties(kr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(kr.prototype,Symbol.toStringTag,{value:"TransformStream",configurable:!0});function Di(e,t,r,s,c,u){function h(){return t}function g(F){return Ui(e,F)}function T(F){return zi(e,F)}function S(){return Mi(e)}e._writable=Bs(h,g,S,T,r,s);function $(){return qi(e)}function C(F){return ji(e,F)}e._readable=Ut(h,$,C,c,u),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Rr(e,!0),e._transformStreamController=void 0}function ro(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof kr}function no(e,t){he(e._readable._readableStreamController,t),Rn(e,t)}function Rn(e,t){$r(e._transformStreamController),Wt(e._writable._writableStreamController,t),Tn(e)}function Tn(e){e._backpressure&&Rr(e,!1)}function Rr(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=d(r=>{e._backpressureChangePromise_resolve=r}),e._backpressure=t}class Ve{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Tr(this))throw Er("desiredSize");let t=this._controlledTransformStream._readable._readableStreamController;return _n(t)}enqueue(t=void 0){if(!Tr(this))throw Er("enqueue");ao(this,t)}error(t=void 0){if(!Tr(this))throw Er("error");Fi(this,t)}terminate(){if(!Tr(this))throw Er("terminate");Bi(this)}}Object.defineProperties(Ve.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),i(Ve.prototype.enqueue,"enqueue"),i(Ve.prototype.error,"error"),i(Ve.prototype.terminate,"terminate"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Ve.prototype,Symbol.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Tr(e){return!o(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof Ve}function Li(e,t,r,s,c){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=r,t._flushAlgorithm=s,t._cancelAlgorithm=c,t._finishPromise=void 0,t._finishPromise_resolve=void 0,t._finishPromise_reject=void 0}function Wi(e,t){let r=Object.create(Ve.prototype),s,c,u;t.transform!==void 0?s=h=>t.transform(h,r):s=h=>{try{return ao(r,h),f(void 0)}catch(g){return m(g)}},t.flush!==void 0?c=()=>t.flush(r):c=()=>f(void 0),t.cancel!==void 0?u=h=>t.cancel(h):u=()=>f(void 0),Li(e,r,s,c,u)}function $r(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0,e._cancelAlgorithm=void 0}function ao(e,t){let r=e._controlledTransformStream,s=r._readable._readableStreamController;if(!St(s))throw new TypeError("Readable side is not in a state that permits enqueue");try{wt(s,t)}catch(u){throw Rn(r,u),r._readable._storedError}di(s)!==r._backpressure&&Rr(r,!0)}function Fi(e,t){no(e._controlledTransformStream,t)}function oo(e,t){let r=e._transformAlgorithm(t);return W(r,void 0,s=>{throw no(e._controlledTransformStream,s),s})}function Bi(e){let t=e._controlledTransformStream,r=t._readable._readableStreamController;tt(r);let s=new TypeError("TransformStream terminated");Rn(t,s)}function Ui(e,t){let r=e._transformStreamController;if(e._backpressure){let s=e._backpressureChangePromise;return W(s,()=>{let c=e._writable;if(c._state==="erroring")throw c._storedError;return oo(r,t)})}return oo(r,t)}function zi(e,t){let r=e._transformStreamController;if(r._finishPromise!==void 0)return r._finishPromise;let s=e._readable;r._finishPromise=d((u,h)=>{r._finishPromise_resolve=u,r._finishPromise_reject=h});let c=r._cancelAlgorithm(t);return $r(r),A(c,()=>(s._state==="errored"?_t(r,s._storedError):(he(s._readableStreamController,t),$n(r)),null),u=>(he(s._readableStreamController,u),_t(r,u),null)),r._finishPromise}function Mi(e){let t=e._transformStreamController;if(t._finishPromise!==void 0)return t._finishPromise;let r=e._readable;t._finishPromise=d((c,u)=>{t._finishPromise_resolve=c,t._finishPromise_reject=u});let s=t._flushAlgorithm();return $r(t),A(s,()=>(r._state==="errored"?_t(t,r._storedError):(tt(r._readableStreamController),$n(t)),null),c=>(he(r._readableStreamController,c),_t(t,c),null)),t._finishPromise}function qi(e){return Rr(e,!1),e._backpressureChangePromise}function ji(e,t){let r=e._transformStreamController;if(r._finishPromise!==void 0)return r._finishPromise;let s=e._writable;r._finishPromise=d((u,h)=>{r._finishPromise_resolve=u,r._finishPromise_reject=h});let c=r._cancelAlgorithm(t);return $r(r),A(c,()=>(s._state==="errored"?_t(r,s._storedError):(Wt(s._writableStreamController,t),Tn(e),$n(r)),null),u=>(Wt(s._writableStreamController,u),Tn(e),_t(r,u),null)),r._finishPromise}function Er(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function $n(e){e._finishPromise_resolve!==void 0&&(e._finishPromise_resolve(),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function _t(e,t){e._finishPromise_reject!==void 0&&(x(e._finishPromise),e._finishPromise_reject(t),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function so(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}a.ByteLengthQueuingStrategy=Sr,a.CountQueuingStrategy=_r,a.ReadableByteStreamController=Ee,a.ReadableStream=V,a.ReadableStreamBYOBReader=Me,a.ReadableStreamBYOBRequest=Qe,a.ReadableStreamDefaultController=ve,a.ReadableStreamDefaultReader=Fe,a.TransformStream=kr,a.TransformStreamDefaultController=Ve,a.WritableStream=qe,a.WritableStreamDefaultController=yt,a.WritableStreamDefaultWriter=Ce}))});var ho=Cn(()=>{if(!globalThis.ReadableStream)try{let a=require("node:process"),{emitWarning:n}=a;try{a.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),a.emitWarning=n}catch(o){throw a.emitWarning=n,o}}catch{Object.assign(globalThis,fo())}try{let{Blob:a}=require("buffer");a&&!a.prototype.stream&&(a.prototype.stream=function(o){let l=0,i=this;return new ReadableStream({type:"bytes",async pull(p){let w=await i.slice(l,Math.min(i.size,l+65536)).arrayBuffer();l+=w.byteLength,p.enqueue(new Uint8Array(w)),l===i.size&&p.close()}})})}catch{}});async function*Pn(a,n=!0){for(let o of a)if("stream"in o)yield*o.stream();else if(ArrayBuffer.isView(o))if(n){let l=o.byteOffset,i=o.byteOffset+o.byteLength;for(;l!==i;){let p=Math.min(i-l,mo),b=o.buffer.slice(l,l+p);l+=b.byteLength,yield new Uint8Array(b)}}else yield o;else{let l=0,i=o;for(;l!==i.size;){let b=await i.slice(l,Math.min(i.size,l+mo)).arrayBuffer();l+=b.byteLength,yield new Uint8Array(b)}}}var El,mo,po,Zi,Ie,qt=Mt(()=>{El=xe(ho(),1);mo=65536;po=class An{#e=[];#t="";#r=0;#n="transparent";constructor(n=[],o={}){if(typeof n!="object"||n===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof n[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof o!="object"&&typeof o!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");o===null&&(o={});let l=new TextEncoder;for(let p of n){let b;ArrayBuffer.isView(p)?b=new Uint8Array(p.buffer.slice(p.byteOffset,p.byteOffset+p.byteLength)):p instanceof ArrayBuffer?b=new Uint8Array(p.slice(0)):p instanceof An?b=p:b=l.encode(`${p}`),this.#r+=ArrayBuffer.isView(b)?b.byteLength:b.size,this.#e.push(b)}this.#n=`${o.endings===void 0?"transparent":o.endings}`;let i=o.type===void 0?"":String(o.type);this.#t=/^[\x20-\x7E]*$/.test(i)?i:""}get size(){return this.#r}get type(){return this.#t}async text(){let n=new TextDecoder,o="";for await(let l of Pn(this.#e,!1))o+=n.decode(l,{stream:!0});return o+=n.decode(),o}async arrayBuffer(){let n=new Uint8Array(this.size),o=0;for await(let l of Pn(this.#e,!1))n.set(l,o),o+=l.length;return n.buffer}stream(){let n=Pn(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(o){let l=await n.next();l.done?o.close():o.enqueue(l.value)},async cancel(){await n.return()}})}slice(n=0,o=this.size,l=""){let{size:i}=this,p=n<0?Math.max(i+n,0):Math.min(n,i),b=o<0?Math.max(i+o,0):Math.min(o,i),w=Math.max(b-p,0),d=this.#e,f=[],m=0;for(let A of d){if(m>=w)break;let L=ArrayBuffer.isView(A)?A.byteLength:A.size;if(p&&L<=p)p-=L,b-=L;else{let y;ArrayBuffer.isView(A)?(y=A.subarray(p,Math.min(L,b)),m+=y.byteLength):(y=A.slice(p,Math.min(L,b)),m+=y.size),b-=L,f.push(y),p=0}}let E=new An([],{type:String(l).toLowerCase()});return E.#r=w,E.#e=f,E}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](n){return n&&typeof n=="object"&&typeof n.constructor=="function"&&(typeof n.stream=="function"||typeof n.arrayBuffer=="function")&&/^(Blob|File)$/.test(n[Symbol.toStringTag])}};Object.defineProperties(po.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});Zi=po,Ie=Zi});var Ji,Xi,Et,xn=Mt(()=>{qt();Ji=class extends Ie{#e=0;#t="";constructor(n,o,l={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(n,l),l===null&&(l={});let i=l.lastModified===void 0?Date.now():Number(l.lastModified);Number.isNaN(i)||(this.#e=i),this.#t=String(o)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](n){return!!n&&n instanceof Ie&&/^(File)$/.test(n[Symbol.toStringTag])}},Xi=Ji,Et=Xi});function yo(a,n=Ie){var o=`${bo()}${bo()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),l=[],i=`--${o}\r
Content-Disposition: form-data; name="`;return a.forEach((p,b)=>typeof p=="string"?l.push(i+In(b)+`"\r
\r
${p.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):l.push(i+In(b)+`"; filename="${In(p.name,1)}"\r
Content-Type: ${p.type||"application/octet-stream"}\r
\r
`,p,`\r
`)),l.push(`--${o}--`),new n(l,{type:"multipart/form-data; boundary="+o})}var jt,el,tl,bo,rl,go,In,nt,at,Ar=Mt(()=>{qt();xn();({toStringTag:jt,iterator:el,hasInstance:tl}=Symbol),bo=Math.random,rl="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),go=(a,n,o)=>(a+="",/^(Blob|File)$/.test(n&&n[jt])?[(o=o!==void 0?o+"":n[jt]=="File"?n.name:"blob",a),n.name!==o||n[jt]=="blob"?new Et([n],o,n):n]:[a,n+""]),In=(a,n)=>(n?a:a.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),nt=(a,n,o)=>{if(n.length<o)throw new TypeError(`Failed to execute '${a}' on 'FormData': ${o} arguments required, but only ${n.length} present.`)},at=class{#e=[];constructor(...n){if(n.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[jt](){return"FormData"}[el](){return this.entries()}static[tl](n){return n&&typeof n=="object"&&n[jt]==="FormData"&&!rl.some(o=>typeof n[o]!="function")}append(...n){nt("append",arguments,2),this.#e.push(go(...n))}delete(n){nt("delete",arguments,1),n+="",this.#e=this.#e.filter(([o])=>o!==n)}get(n){nt("get",arguments,1),n+="";for(var o=this.#e,l=o.length,i=0;i<l;i++)if(o[i][0]===n)return o[i][1];return null}getAll(n,o){return nt("getAll",arguments,1),o=[],n+="",this.#e.forEach(l=>l[0]===n&&o.push(l[1])),o}has(n){return nt("has",arguments,1),n+="",this.#e.some(o=>o[0]===n)}forEach(n,o){nt("forEach",arguments,1);for(var[l,i]of this)n.call(o,i,l,this)}set(...n){nt("set",arguments,2);var o=[],l=!0;n=go(...n),this.#e.forEach(i=>{i[0]===n[0]?l&&(l=!o.push(n)):o.push(i)}),l&&o.push(n),this.#e=o}*entries(){yield*this.#e}*keys(){for(var[n]of this)yield n}*values(){for(var[,n]of this)yield n}}});var Ro=Cn((Ul,ko)=>{if(!globalThis.DOMException)try{let{MessageChannel:a}=require("worker_threads"),n=new a().port1,o=new ArrayBuffer;n.postMessage(o,[o,o])}catch(a){a.constructor.name==="DOMException"&&(globalThis.DOMException=a.constructor)}ko.exports=globalThis.DOMException});var Ir,nl,ql,Dn=Mt(()=>{Ir=require("node:fs"),nl=xe(Ro(),1);xn();qt();({stat:ql}=Ir.promises)});var $o={};vn($o,{toFormData:()=>ul});function cl(a){let n=a.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!n)return;let o=n[2]||n[3]||"",l=o.slice(o.lastIndexOf("\\")+1);return l=l.replace(/%22/g,'"'),l=l.replace(/&#(\d{4});/g,(i,p)=>String.fromCharCode(p)),l}async function ul(a,n){if(!/multipart/i.test(n))throw new TypeError("Failed to fetch");let o=n.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!o)throw new TypeError("no or bad content-type header, no multipart boundary");let l=new Ln(o[1]||o[2]),i,p,b,w,d,f,m=[],E=new at,A=k=>{b+=x.decode(k,{stream:!0})},L=k=>{m.push(k)},y=()=>{let k=new Et(m,f,{type:d});E.append(w,k)},W=()=>{E.append(w,b)},x=new TextDecoder("utf-8");x.decode(),l.onPartBegin=function(){l.onPartData=A,l.onPartEnd=W,i="",p="",b="",w="",d="",f=null,m.length=0},l.onHeaderField=function(k){i+=x.decode(k,{stream:!0})},l.onHeaderValue=function(k){p+=x.decode(k,{stream:!0})},l.onHeaderEnd=function(){if(p+=x.decode(),i=i.toLowerCase(),i==="content-disposition"){let k=p.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);k&&(w=k[2]||k[3]||""),f=cl(p),f&&(l.onPartData=L,l.onPartEnd=y)}else i==="content-type"&&(d=p);p="",i=""};for await(let k of a)l.write(k);return l.end(),E}var Se,U,To,Ge,Or,Dr,al,Vt,ol,sl,il,ll,ot,Ln,Eo=Mt(()=>{Dn();Ar();Se=0,U={START_BOUNDARY:Se++,HEADER_FIELD_START:Se++,HEADER_FIELD:Se++,HEADER_VALUE_START:Se++,HEADER_VALUE:Se++,HEADER_VALUE_ALMOST_DONE:Se++,HEADERS_ALMOST_DONE:Se++,PART_DATA_START:Se++,PART_DATA:Se++,END:Se++},To=1,Ge={PART_BOUNDARY:To,LAST_BOUNDARY:To*=2},Or=10,Dr=13,al=32,Vt=45,ol=58,sl=97,il=122,ll=a=>a|32,ot=()=>{},Ln=class{constructor(n){this.index=0,this.flags=0,this.onHeaderEnd=ot,this.onHeaderField=ot,this.onHeadersEnd=ot,this.onHeaderValue=ot,this.onPartBegin=ot,this.onPartData=ot,this.onPartEnd=ot,this.boundaryChars={},n=`\r
--`+n;let o=new Uint8Array(n.length);for(let l=0;l<n.length;l++)o[l]=n.charCodeAt(l),this.boundaryChars[o[l]]=!0;this.boundary=o,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=U.START_BOUNDARY}write(n){let o=0,l=n.length,i=this.index,{lookbehind:p,boundary:b,boundaryChars:w,index:d,state:f,flags:m}=this,E=this.boundary.length,A=E-1,L=n.length,y,W,x=P=>{this[P+"Mark"]=o},k=P=>{delete this[P+"Mark"]},R=(P,v,O,We)=>{(v===void 0||v!==O)&&this[P](We&&We.subarray(v,O))},D=(P,v)=>{let O=P+"Mark";O in this&&(v?(R(P,this[O],o,n),delete this[O]):(R(P,this[O],n.length,n),this[O]=0))};for(o=0;o<l;o++)switch(y=n[o],f){case U.START_BOUNDARY:if(d===b.length-2){if(y===Vt)m|=Ge.LAST_BOUNDARY;else if(y!==Dr)return;d++;break}else if(d-1===b.length-2){if(m&Ge.LAST_BOUNDARY&&y===Vt)f=U.END,m=0;else if(!(m&Ge.LAST_BOUNDARY)&&y===Or)d=0,R("onPartBegin"),f=U.HEADER_FIELD_START;else return;break}y!==b[d+2]&&(d=-2),y===b[d+2]&&d++;break;case U.HEADER_FIELD_START:f=U.HEADER_FIELD,x("onHeaderField"),d=0;case U.HEADER_FIELD:if(y===Dr){k("onHeaderField"),f=U.HEADERS_ALMOST_DONE;break}if(d++,y===Vt)break;if(y===ol){if(d===1)return;D("onHeaderField",!0),f=U.HEADER_VALUE_START;break}if(W=ll(y),W<sl||W>il)return;break;case U.HEADER_VALUE_START:if(y===al)break;x("onHeaderValue"),f=U.HEADER_VALUE;case U.HEADER_VALUE:y===Dr&&(D("onHeaderValue",!0),R("onHeaderEnd"),f=U.HEADER_VALUE_ALMOST_DONE);break;case U.HEADER_VALUE_ALMOST_DONE:if(y!==Or)return;f=U.HEADER_FIELD_START;break;case U.HEADERS_ALMOST_DONE:if(y!==Or)return;R("onHeadersEnd"),f=U.PART_DATA_START;break;case U.PART_DATA_START:f=U.PART_DATA,x("onPartData");case U.PART_DATA:if(i=d,d===0){for(o+=A;o<L&&!(n[o]in w);)o+=E;o-=A,y=n[o]}if(d<b.length)b[d]===y?(d===0&&D("onPartData",!0),d++):d=0;else if(d===b.length)d++,y===Dr?m|=Ge.PART_BOUNDARY:y===Vt?m|=Ge.LAST_BOUNDARY:d=0;else if(d-1===b.length)if(m&Ge.PART_BOUNDARY){if(d=0,y===Or){m&=~Ge.PART_BOUNDARY,R("onPartEnd"),R("onPartBegin"),f=U.HEADER_FIELD_START;break}}else m&Ge.LAST_BOUNDARY&&y===Vt?(R("onPartEnd"),f=U.END,m=0):d=0;if(d>0)p[d-1]=y;else if(i>0){let P=new Uint8Array(p.buffer,p.byteOffset,p.byteLength);R("onPartData",0,i,P),i=0,x("onPartData"),o--}break;case U.END:break;default:throw new Error(`Unexpected state entered: ${f}`)}D("onHeaderField"),D("onHeaderValue"),D("onPartData"),this.index=d,this.state=f,this.flags=m}end(){if(this.state===U.HEADER_FIELD_START&&this.index===0||this.state===U.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==U.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var _l={};vn(_l,{default:()=>Xo});module.exports=Qi(_l);var Q=require("@raycast/api"),Zt=require("react");var j=require("@raycast/api"),ke=require("react");var ct={};vn(ct,{authorize:()=>lt,client:()=>ae});var Qt=require("@raycast/api");var Mo=xe(require("node:http"),1),qo=xe(require("node:https"),1),it=xe(require("node:zlib"),1),ne=xe(require("node:stream"),1),Yt=require("node:buffer");function Ki(a){if(!/^data:/i.test(a))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');a=a.replace(/\r?\n/g,"");let n=a.indexOf(",");if(n===-1||n<=4)throw new TypeError("malformed data: URI");let o=a.substring(5,n).split(";"),l="",i=!1,p=o[0]||"text/plain",b=p;for(let m=1;m<o.length;m++)o[m]==="base64"?i=!0:o[m]&&(b+=`;${o[m]}`,o[m].indexOf("charset=")===0&&(l=o[m].substring(8)));!o[0]&&!l.length&&(b+=";charset=US-ASCII",l="US-ASCII");let w=i?"base64":"ascii",d=unescape(a.substring(n+1)),f=Buffer.from(d,w);return f.type=p,f.typeFull=b,f.charset=l,f}var co=Ki;var ue=xe(require("node:stream"),1),De=require("node:util"),te=require("node:buffer");qt();Ar();var Oe=class extends Error{constructor(n,o){super(n),Error.captureStackTrace(this,this.constructor),this.type=o}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var Z=class extends Oe{constructor(n,o,l){super(n,o),l&&(this.code=this.errno=l.code,this.erroredSysCall=l.syscall)}};var xr=Symbol.toStringTag,On=a=>typeof a=="object"&&typeof a.append=="function"&&typeof a.delete=="function"&&typeof a.get=="function"&&typeof a.getAll=="function"&&typeof a.has=="function"&&typeof a.set=="function"&&typeof a.sort=="function"&&a[xr]==="URLSearchParams",Nt=a=>a&&typeof a=="object"&&typeof a.arrayBuffer=="function"&&typeof a.type=="string"&&typeof a.stream=="function"&&typeof a.constructor=="function"&&/^(Blob|File)$/.test(a[xr]),wo=a=>typeof a=="object"&&(a[xr]==="AbortSignal"||a[xr]==="EventTarget"),So=(a,n)=>{let o=new URL(n).hostname,l=new URL(a).hostname;return o===l||o.endsWith(`.${l}`)},_o=(a,n)=>{let o=new URL(n).protocol,l=new URL(a).protocol;return o===l};var fl=(0,De.promisify)(ue.default.pipeline),J=Symbol("Body internals"),_e=class{constructor(n,{size:o=0}={}){let l=null;n===null?n=null:On(n)?n=te.Buffer.from(n.toString()):Nt(n)||te.Buffer.isBuffer(n)||(De.types.isAnyArrayBuffer(n)?n=te.Buffer.from(n):ArrayBuffer.isView(n)?n=te.Buffer.from(n.buffer,n.byteOffset,n.byteLength):n instanceof ue.default||(n instanceof at?(n=yo(n),l=n.type.split("=")[1]):n=te.Buffer.from(String(n))));let i=n;te.Buffer.isBuffer(n)?i=ue.default.Readable.from(n):Nt(n)&&(i=ue.default.Readable.from(n.stream())),this[J]={body:n,stream:i,boundary:l,disturbed:!1,error:null},this.size=o,n instanceof ue.default&&n.on("error",p=>{let b=p instanceof Oe?p:new Z(`Invalid response body while trying to fetch ${this.url}: ${p.message}`,"system",p);this[J].error=b})}get body(){return this[J].stream}get bodyUsed(){return this[J].disturbed}async arrayBuffer(){let{buffer:n,byteOffset:o,byteLength:l}=await Wn(this);return n.slice(o,o+l)}async formData(){let n=this.headers.get("content-type");if(n.startsWith("application/x-www-form-urlencoded")){let l=new at,i=new URLSearchParams(await this.text());for(let[p,b]of i)l.append(p,b);return l}let{toFormData:o}=await Promise.resolve().then(()=>(Eo(),$o));return o(this.body,n)}async blob(){let n=this.headers&&this.headers.get("content-type")||this[J].body&&this[J].body.type||"",o=await this.arrayBuffer();return new Ie([o],{type:n})}async json(){let n=await this.text();return JSON.parse(n)}async text(){let n=await Wn(this);return new TextDecoder().decode(n)}buffer(){return Wn(this)}};_e.prototype.buffer=(0,De.deprecate)(_e.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(_e.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,De.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function Wn(a){if(a[J].disturbed)throw new TypeError(`body used already for: ${a.url}`);if(a[J].disturbed=!0,a[J].error)throw a[J].error;let{body:n}=a;if(n===null)return te.Buffer.alloc(0);if(!(n instanceof ue.default))return te.Buffer.alloc(0);let o=[],l=0;try{for await(let i of n){if(a.size>0&&l+i.length>a.size){let p=new Z(`content size at ${a.url} over limit: ${a.size}`,"max-size");throw n.destroy(p),p}l+=i.length,o.push(i)}}catch(i){throw i instanceof Oe?i:new Z(`Invalid response body while trying to fetch ${a.url}: ${i.message}`,"system",i)}if(n.readableEnded===!0||n._readableState.ended===!0)try{return o.every(i=>typeof i=="string")?te.Buffer.from(o.join("")):te.Buffer.concat(o,l)}catch(i){throw new Z(`Could not create Buffer from response body for ${a.url}: ${i.message}`,"system",i)}else throw new Z(`Premature close of server response while trying to fetch ${a.url}`)}var Ct=(a,n)=>{let o,l,{body:i}=a[J];if(a.bodyUsed)throw new Error("cannot clone body after it is used");return i instanceof ue.default&&typeof i.getBoundary!="function"&&(o=new ue.PassThrough({highWaterMark:n}),l=new ue.PassThrough({highWaterMark:n}),i.pipe(o),i.pipe(l),a[J].stream=o,i=l),i},dl=(0,De.deprecate)(a=>a.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Lr=(a,n)=>a===null?null:typeof a=="string"?"text/plain;charset=UTF-8":On(a)?"application/x-www-form-urlencoded;charset=UTF-8":Nt(a)?a.type||null:te.Buffer.isBuffer(a)||De.types.isAnyArrayBuffer(a)||ArrayBuffer.isView(a)?null:a instanceof at?`multipart/form-data; boundary=${n[J].boundary}`:a&&typeof a.getBoundary=="function"?`multipart/form-data;boundary=${dl(a)}`:a instanceof ue.default?null:"text/plain;charset=UTF-8",Co=a=>{let{body:n}=a[J];return n===null?0:Nt(n)?n.size:te.Buffer.isBuffer(n)?n.length:n&&typeof n.getLengthSync=="function"&&n.hasKnownLength&&n.hasKnownLength()?n.getLengthSync():null},vo=async(a,{body:n})=>{n===null?a.end():await fl(n,a)};var Fn=require("node:util"),Ht=xe(require("node:http"),1),Wr=typeof Ht.default.validateHeaderName=="function"?Ht.default.validateHeaderName:a=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(a)){let n=new TypeError(`Header name must be a valid HTTP token [${a}]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),n}},Bn=typeof Ht.default.validateHeaderValue=="function"?Ht.default.validateHeaderValue:(a,n)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(n)){let o=new TypeError(`Invalid character in header content ["${a}"]`);throw Object.defineProperty(o,"code",{value:"ERR_INVALID_CHAR"}),o}},re=class a extends URLSearchParams{constructor(n){let o=[];if(n instanceof a){let l=n.raw();for(let[i,p]of Object.entries(l))o.push(...p.map(b=>[i,b]))}else if(n!=null)if(typeof n=="object"&&!Fn.types.isBoxedPrimitive(n)){let l=n[Symbol.iterator];if(l==null)o.push(...Object.entries(n));else{if(typeof l!="function")throw new TypeError("Header pairs must be iterable");o=[...n].map(i=>{if(typeof i!="object"||Fn.types.isBoxedPrimitive(i))throw new TypeError("Each header pair must be an iterable object");return[...i]}).map(i=>{if(i.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...i]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return o=o.length>0?o.map(([l,i])=>(Wr(l),Bn(l,String(i)),[String(l).toLowerCase(),String(i)])):void 0,super(o),new Proxy(this,{get(l,i,p){switch(i){case"append":case"set":return(b,w)=>(Wr(b),Bn(b,String(w)),URLSearchParams.prototype[i].call(l,String(b).toLowerCase(),String(w)));case"delete":case"has":case"getAll":return b=>(Wr(b),URLSearchParams.prototype[i].call(l,String(b).toLowerCase()));case"keys":return()=>(l.sort(),new Set(URLSearchParams.prototype.keys.call(l)).keys());default:return Reflect.get(l,i,p)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(n){let o=this.getAll(n);if(o.length===0)return null;let l=o.join(", ");return/^content-encoding$/i.test(n)&&(l=l.toLowerCase()),l}forEach(n,o=void 0){for(let l of this.keys())Reflect.apply(n,o,[this.get(l),l,this])}*values(){for(let n of this.keys())yield this.get(n)}*entries(){for(let n of this.keys())yield[n,this.get(n)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((n,o)=>(n[o]=this.getAll(o),n),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((n,o)=>{let l=this.getAll(o);return o==="host"?n[o]=l[0]:n[o]=l.length>1?l:l[0],n},{})}};Object.defineProperties(re.prototype,["get","entries","forEach","values"].reduce((a,n)=>(a[n]={enumerable:!0},a),{}));function Po(a=[]){return new re(a.reduce((n,o,l,i)=>(l%2===0&&n.push(i.slice(l,l+2)),n),[]).filter(([n,o])=>{try{return Wr(n),Bn(n,String(o)),!0}catch{return!1}}))}var hl=new Set([301,302,303,307,308]),Fr=a=>hl.has(a);var be=Symbol("Response internals"),fe=class a extends _e{constructor(n=null,o={}){super(n,o);let l=o.status!=null?o.status:200,i=new re(o.headers);if(n!==null&&!i.has("Content-Type")){let p=Lr(n,this);p&&i.append("Content-Type",p)}this[be]={type:"default",url:o.url,status:l,statusText:o.statusText||"",headers:i,counter:o.counter,highWaterMark:o.highWaterMark}}get type(){return this[be].type}get url(){return this[be].url||""}get status(){return this[be].status}get ok(){return this[be].status>=200&&this[be].status<300}get redirected(){return this[be].counter>0}get statusText(){return this[be].statusText}get headers(){return this[be].headers}get highWaterMark(){return this[be].highWaterMark}clone(){return new a(Ct(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(n,o=302){if(!Fr(o))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new a(null,{headers:{location:new URL(n).toString()},status:o})}static error(){let n=new a(null,{status:0,statusText:""});return n[be].type="error",n}static json(n=void 0,o={}){let l=JSON.stringify(n);if(l===void 0)throw new TypeError("data is not JSON serializable");let i=new re(o&&o.headers);return i.has("content-type")||i.set("content-type","application/json"),new a(l,{...o,headers:i})}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(fe.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Bo=require("node:url"),Uo=require("node:util");var Ao=a=>{if(a.search)return a.search;let n=a.href.length-1,o=a.hash||(a.href[n]==="#"?"#":"");return a.href[n-o.length]==="?"?"?":""};var Io=require("node:net");function xo(a,n=!1){return a==null||(a=new URL(a),/^(about|blob|data):$/.test(a.protocol))?"no-referrer":(a.username="",a.password="",a.hash="",n&&(a.pathname="",a.search=""),a)}var Oo=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Do="strict-origin-when-cross-origin";function Lo(a){if(!Oo.has(a))throw new TypeError(`Invalid referrerPolicy: ${a}`);return a}function ml(a){if(/^(http|ws)s:$/.test(a.protocol))return!0;let n=a.host.replace(/(^\[)|(]$)/g,""),o=(0,Io.isIP)(n);return o===4&&/^127\./.test(n)||o===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(n)?!0:a.host==="localhost"||a.host.endsWith(".localhost")?!1:a.protocol==="file:"}function vt(a){return/^about:(blank|srcdoc)$/.test(a)||a.protocol==="data:"||/^(blob|filesystem):$/.test(a.protocol)?!0:ml(a)}function Wo(a,{referrerURLCallback:n,referrerOriginCallback:o}={}){if(a.referrer==="no-referrer"||a.referrerPolicy==="")return null;let l=a.referrerPolicy;if(a.referrer==="about:client")return"no-referrer";let i=a.referrer,p=xo(i),b=xo(i,!0);p.toString().length>4096&&(p=b),n&&(p=n(p)),o&&(b=o(b));let w=new URL(a.url);switch(l){case"no-referrer":return"no-referrer";case"origin":return b;case"unsafe-url":return p;case"strict-origin":return vt(p)&&!vt(w)?"no-referrer":b.toString();case"strict-origin-when-cross-origin":return p.origin===w.origin?p:vt(p)&&!vt(w)?"no-referrer":b;case"same-origin":return p.origin===w.origin?p:"no-referrer";case"origin-when-cross-origin":return p.origin===w.origin?p:b;case"no-referrer-when-downgrade":return vt(p)&&!vt(w)?"no-referrer":p;default:throw new TypeError(`Invalid referrerPolicy: ${l}`)}}function Fo(a){let n=(a.get("referrer-policy")||"").split(/[,\s]+/),o="";for(let l of n)l&&Oo.has(l)&&(o=l);return o}var q=Symbol("Request internals"),Gt=a=>typeof a=="object"&&typeof a[q]=="object",pl=(0,Uo.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),st=class a extends _e{constructor(n,o={}){let l;if(Gt(n)?l=new URL(n.url):(l=new URL(n),n={}),l.username!==""||l.password!=="")throw new TypeError(`${l} is an url with embedded credentials.`);let i=o.method||n.method||"GET";if(/^(delete|get|head|options|post|put)$/i.test(i)&&(i=i.toUpperCase()),!Gt(o)&&"data"in o&&pl(),(o.body!=null||Gt(n)&&n.body!==null)&&(i==="GET"||i==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let p=o.body?o.body:Gt(n)&&n.body!==null?Ct(n):null;super(p,{size:o.size||n.size||0});let b=new re(o.headers||n.headers||{});if(p!==null&&!b.has("Content-Type")){let f=Lr(p,this);f&&b.set("Content-Type",f)}let w=Gt(n)?n.signal:null;if("signal"in o&&(w=o.signal),w!=null&&!wo(w))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let d=o.referrer==null?n.referrer:o.referrer;if(d==="")d="no-referrer";else if(d){let f=new URL(d);d=/^about:(\/\/)?client$/.test(f)?"client":f}else d=void 0;this[q]={method:i,redirect:o.redirect||n.redirect||"follow",headers:b,parsedURL:l,signal:w,referrer:d},this.follow=o.follow===void 0?n.follow===void 0?20:n.follow:o.follow,this.compress=o.compress===void 0?n.compress===void 0?!0:n.compress:o.compress,this.counter=o.counter||n.counter||0,this.agent=o.agent||n.agent,this.highWaterMark=o.highWaterMark||n.highWaterMark||16384,this.insecureHTTPParser=o.insecureHTTPParser||n.insecureHTTPParser||!1,this.referrerPolicy=o.referrerPolicy||n.referrerPolicy||""}get method(){return this[q].method}get url(){return(0,Bo.format)(this[q].parsedURL)}get headers(){return this[q].headers}get redirect(){return this[q].redirect}get signal(){return this[q].signal}get referrer(){if(this[q].referrer==="no-referrer")return"";if(this[q].referrer==="client")return"about:client";if(this[q].referrer)return this[q].referrer.toString()}get referrerPolicy(){return this[q].referrerPolicy}set referrerPolicy(n){this[q].referrerPolicy=Lo(n)}clone(){return new a(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(st.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var zo=a=>{let{parsedURL:n}=a[q],o=new re(a[q].headers);o.has("Accept")||o.set("Accept","*/*");let l=null;if(a.body===null&&/^(post|put)$/i.test(a.method)&&(l="0"),a.body!==null){let w=Co(a);typeof w=="number"&&!Number.isNaN(w)&&(l=String(w))}l&&o.set("Content-Length",l),a.referrerPolicy===""&&(a.referrerPolicy=Do),a.referrer&&a.referrer!=="no-referrer"?a[q].referrer=Wo(a):a[q].referrer="no-referrer",a[q].referrer instanceof URL&&o.set("Referer",a.referrer),o.has("User-Agent")||o.set("User-Agent","node-fetch"),a.compress&&!o.has("Accept-Encoding")&&o.set("Accept-Encoding","gzip, deflate, br");let{agent:i}=a;typeof i=="function"&&(i=i(n));let p=Ao(n),b={path:n.pathname+p,method:a.method,headers:o[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:a.insecureHTTPParser,agent:i};return{parsedURL:n,options:b}};var Br=class extends Oe{constructor(n,o="aborted"){super(n,o)}};Ar();Dn();var bl=new Set(["data:","http:","https:"]);async function de(a,n){return new Promise((o,l)=>{let i=new st(a,n),{parsedURL:p,options:b}=zo(i);if(!bl.has(p.protocol))throw new TypeError(`node-fetch cannot load ${a}. URL scheme "${p.protocol.replace(/:$/,"")}" is not supported.`);if(p.protocol==="data:"){let y=co(i.url),W=new fe(y,{headers:{"Content-Type":y.typeFull}});o(W);return}let w=(p.protocol==="https:"?qo.default:Mo.default).request,{signal:d}=i,f=null,m=()=>{let y=new Br("The operation was aborted.");l(y),i.body&&i.body instanceof ne.default.Readable&&i.body.destroy(y),!(!f||!f.body)&&f.body.emit("error",y)};if(d&&d.aborted){m();return}let E=()=>{m(),L()},A=w(p.toString(),b);d&&d.addEventListener("abort",E);let L=()=>{A.abort(),d&&d.removeEventListener("abort",E)};A.on("error",y=>{l(new Z(`request to ${i.url} failed, reason: ${y.message}`,"system",y)),L()}),gl(A,y=>{f&&f.body&&f.body.destroy(y)}),process.version<"v14"&&A.on("socket",y=>{let W;y.prependListener("end",()=>{W=y._eventsCount}),y.prependListener("close",x=>{if(f&&W<y._eventsCount&&!x){let k=new Error("Premature close");k.code="ERR_STREAM_PREMATURE_CLOSE",f.body.emit("error",k)}})}),A.on("response",y=>{A.setTimeout(0);let W=Po(y.rawHeaders);if(Fr(y.statusCode)){let P=W.get("Location"),v=null;try{v=P===null?null:new URL(P,i.url)}catch{if(i.redirect!=="manual"){l(new Z(`uri requested responds with an invalid redirect URL: ${P}`,"invalid-redirect")),L();return}}switch(i.redirect){case"error":l(new Z(`uri requested responds with a redirect, redirect mode is set to error: ${i.url}`,"no-redirect")),L();return;case"manual":break;case"follow":{if(v===null)break;if(i.counter>=i.follow){l(new Z(`maximum redirect reached at: ${i.url}`,"max-redirect")),L();return}let O={headers:new re(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:Ct(i),signal:i.signal,size:i.size,referrer:i.referrer,referrerPolicy:i.referrerPolicy};if(!So(i.url,v)||!_o(i.url,v))for(let At of["authorization","www-authenticate","cookie","cookie2"])O.headers.delete(At);if(y.statusCode!==303&&i.body&&n.body instanceof ne.default.Readable){l(new Z("Cannot follow redirect with body being a readable stream","unsupported-redirect")),L();return}(y.statusCode===303||(y.statusCode===301||y.statusCode===302)&&i.method==="POST")&&(O.method="GET",O.body=void 0,O.headers.delete("content-length"));let We=Fo(W);We&&(O.referrerPolicy=We),o(de(new st(v,O))),L();return}default:return l(new TypeError(`Redirect option '${i.redirect}' is not a valid value of RequestRedirect`))}}d&&y.once("end",()=>{d.removeEventListener("abort",E)});let x=(0,ne.pipeline)(y,new ne.PassThrough,P=>{P&&l(P)});process.version<"v12.10"&&y.on("aborted",E);let k={url:i.url,status:y.statusCode,statusText:y.statusMessage,headers:W,size:i.size,counter:i.counter,highWaterMark:i.highWaterMark},R=W.get("Content-Encoding");if(!i.compress||i.method==="HEAD"||R===null||y.statusCode===204||y.statusCode===304){f=new fe(x,k),o(f);return}let D={flush:it.default.Z_SYNC_FLUSH,finishFlush:it.default.Z_SYNC_FLUSH};if(R==="gzip"||R==="x-gzip"){x=(0,ne.pipeline)(x,it.default.createGunzip(D),P=>{P&&l(P)}),f=new fe(x,k),o(f);return}if(R==="deflate"||R==="x-deflate"){let P=(0,ne.pipeline)(y,new ne.PassThrough,v=>{v&&l(v)});P.once("data",v=>{(v[0]&15)===8?x=(0,ne.pipeline)(x,it.default.createInflate(),O=>{O&&l(O)}):x=(0,ne.pipeline)(x,it.default.createInflateRaw(),O=>{O&&l(O)}),f=new fe(x,k),o(f)}),P.once("end",()=>{f||(f=new fe(x,k),o(f))});return}if(R==="br"){x=(0,ne.pipeline)(x,it.default.createBrotliDecompress(),P=>{P&&l(P)}),f=new fe(x,k),o(f);return}f=new fe(x,k),o(f)}),vo(A,i).catch(l)})}function gl(a,n){let o=Yt.Buffer.from(`0\r
\r
`),l=!1,i=!1,p;a.on("response",b=>{let{headers:w}=b;l=w["transfer-encoding"]==="chunked"&&!w["content-length"]}),a.on("socket",b=>{let w=()=>{if(l&&!i){let f=new Error("Premature close");f.code="ERR_STREAM_PREMATURE_CLOSE",n(f)}},d=f=>{i=Yt.Buffer.compare(f.slice(-5),o)===0,!i&&p&&(i=Yt.Buffer.compare(p.slice(-3),o.slice(0,3))===0&&Yt.Buffer.compare(f.slice(-2),o.slice(3))===0),p=f};b.prependListener("close",w),b.on("data",d),a.on("close",()=>{b.removeListener("close",w),b.removeListener("data",d)})})}var Un=(0,Qt.getPreferenceValues)().clientId,ae=new Qt.OAuth.PKCEClient({redirectMethod:Qt.OAuth.RedirectMethod.AppURI,providerName:"Google",providerIcon:"google-logo.png",providerId:"google",description:"Connect your Google account"});async function lt(){let a=await ae.getTokens();if(a?.accessToken){a.refreshToken&&a.isExpired()&&await ae.setTokens(await wl(a.refreshToken));return}let n=await ae.authorizationRequest({endpoint:"https://accounts.google.com/o/oauth2/v2/auth",clientId:Un,scope:"https://www.googleapis.com/auth/tasks"}),{authorizationCode:o}=await ae.authorize(n);await ae.setTokens(await yl(n,o))}async function yl(a,n){let o=new URLSearchParams;o.append("client_id",Un),o.append("code",n),o.append("verifier",a.codeVerifier),o.append("grant_type","authorization_code"),o.append("redirect_uri",a.redirectURI);let l=await de("https://oauth2.googleapis.com/token",{method:"POST",body:o});if(!l.ok)throw console.error("fetch tokens error:",await l.text()),new Error(l.statusText);return await l.json()}async function wl(a){let n=new URLSearchParams;n.append("client_id",Un),n.append("refresh_token",a),n.append("grant_type","refresh_token");let o=await de("https://oauth2.googleapis.com/token",{method:"POST",body:n});if(!o.ok)throw console.error("refresh tokens error:",await o.text()),new Error(o.statusText);let l=await o.json();return l.refresh_token=l.refresh_token??a,l}var ut=require("@raycast/api");function ft(a){return a.status==="completed"}function jo(a,n){return n.filter(function(l){return l.parent==a.id})}function zn(a){let n=a.due===void 0?new Date:new Date(a.due),o=new Date;return o.setHours(0,0,0,0),!ft(a)&&n<o?{source:ut.Icon.Circle,tintColor:ut.Color.Red}:ft(a)?{source:ut.Icon.Checkmark,tintColor:ut.Color.Green}:{source:ut.Icon.Circle}}async function Ur(){let a=await de("https://tasks.googleapis.com/tasks/v1/users/@me/lists",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${(await ae.getTokens())?.accessToken}`}});if(!a.ok)throw console.error("fetch items error:",await a.text()),new Error(a.statusText);return(await a.json()).items.map(o=>({id:o.id,title:o.title}))}async function Pt(a,n=!1){let o=new URLSearchParams;o.append("showHidden","true"),o.append("maxResults","100"),n?o.append("showCompleted","true"):o.append("showCompleted","false");let l=await de(`https://tasks.googleapis.com/tasks/v1/lists/${a}/tasks?`+o.toString(),{headers:{"Content-Type":"application/json",Authorization:`Bearer ${(await ae.getTokens())?.accessToken}`}});if(!l.ok)throw console.error("fetch items error:",await l.text()),new Error(l.statusText);return(await l.json()).items.map(b=>({id:b.id,title:b.title,status:b.status,due:b.due,completed:b.completed,parent:b.parent,notes:b.notes})).sort((b,w)=>{if(b.status==="completed"&&w.status==="completed"){let m=b.completed?new Date(b.completed):null;return((w.completed?new Date(w.completed):null)?.getTime()??0)-(m?.getTime()??0)}let d=b.due!==void 0?new Date(b.due):null,f=w.due!==void 0?new Date(w.due):null;return d&&f?d.getTime()-f.getTime():d?-1:f?1:0})}async function No(a,n){let o=await de(`https://tasks.googleapis.com/tasks/v1/lists/${a}/tasks/${n}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${(await ae.getTokens())?.accessToken}`}});if(!o.ok)throw console.error("fetch items error:",await o.text()),new Error(o.statusText)}async function Vo(a,n){let o=await de(`https://tasks.googleapis.com/tasks/v1/lists/${a}/tasks`,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:`Bearer ${(await ae.getTokens())?.accessToken}`}});if(!o.ok)throw console.error("fetch items error:",await o.text()),new Error(o.statusText)}async function Ho(a,n){let o=await de(`https://tasks.googleapis.com/tasks/v1/lists/${a}/tasks/${n.id}`,{method:"PATCH",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:`Bearer ${(await ae.getTokens())?.accessToken}`}});if(!o.ok)throw console.error("fetch items error:",await o.text()),new Error(o.statusText)}async function Go(a,n){let o={status:""};ft(n)?o.status="needsAction":o.status="completed";let l=await de(`https://tasks.googleapis.com/tasks/v1/lists/${a}/tasks/${n.id}`,{method:"PATCH",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:`Bearer ${(await ae.getTokens())?.accessToken}`}});if(!l.ok)throw console.error("fetch items error:",await l.text()),new Error(l.statusText)}var M=require("@raycast/api");var z=require("@raycast/api"),Kt=require("react");var N=xe(require("react")),H=require("@raycast/api");var Qo=require("react/jsx-runtime");function Yo(a){let n=(0,N.useRef)(a);return n.current=a,n}var Ko=(function(a){return a.Required="required",a})({});function Mn(a,n){if(a){if(typeof a=="function")return a(n);if(a==="required"){let o=typeof n<"u"&&n!==null;if(o)switch(typeof n){case"string":o=n.length>0;break;case"object":Array.isArray(n)?o=n.length>0:n instanceof Date&&(o=n.getTime()>0);break;default:break}if(!o)return"The item is required"}}}function Zo(a){let{onSubmit:n,validation:o,initialValues:l={}}=a,[i,p]=(0,N.useState)(l),[b,w]=(0,N.useState)({}),d=(0,N.useRef)({}),f=Yo(o||{}),m=Yo(n),E=(0,N.useCallback)(k=>{d.current[k]?.focus()},[d]),A=(0,N.useCallback)(async k=>{let R=!1;for(let[P,v]of Object.entries(f.current)){let O=Mn(v,k[P]);O&&(R||(R={},E(P)),R[P]=O)}if(R)return w(R),!1;let D=await m.current(k);return typeof D=="boolean"?D:!0},[f,m,E]),L=(0,N.useCallback)((k,R)=>{w(D=>({...D,[k]:R}))},[w]),y=(0,N.useCallback)(function(k,R){p(D=>({...D,[k]:typeof R=="function"?R(D[k]):R}))},[p]),W=(0,N.useMemo)(()=>new Proxy({},{get(k,R){let D=f.current[R],P=i[R];return{onChange(v){b[R]&&(Mn(D,v)||L(R,void 0)),y(R,v)},onBlur(v){let O=Mn(D,v.target.value);O&&L(R,O)},error:b[R],id:R,value:typeof P>"u"?null:P,ref:v=>{d.current[R]=v}}}}),[b,f,L,i,d,y]),x=(0,N.useCallback)(k=>{w({}),Object.entries(d.current).forEach(([R,D])=>{k?.[R]||D?.reset()}),k&&p(k)},[p,w,d]);return{handleSubmit:A,setValidationError:L,setValue:y,values:i,itemProps:W,focus:E,reset:x}}var ge=require("react/jsx-runtime");function dt(a){let[n,o]=(0,Kt.useState)(!0),[l,i]=(0,Kt.useState)([]),{pop:p}=(0,z.useNavigation)(),{handleSubmit:b,itemProps:w}=Zo({onSubmit(d){a.onCreate(d.listId,{title:d.title,notes:d.notes,due:d.due}),(0,z.showToast)({style:z.Toast.Style.Success,title:"Task Created!",message:`${d.title} created`}),p()},initialValues:{title:a.title,listId:a.listId},validation:{title:Ko.Required}});return(0,Kt.useEffect)(()=>{(async()=>{try{await lt();let d=await Ur();i(d),o(!1)}catch(d){console.error(d),o(!1),(0,z.showToast)({style:z.Toast.Style.Failure,title:String(d)})}})()},[ct]),n?(0,ge.jsx)(z.Detail,{isLoading:n}):(0,ge.jsxs)(z.Form,{actions:(0,ge.jsx)(z.ActionPanel,{children:(0,ge.jsx)(z.Action.SubmitForm,{title:"Create Task",onSubmit:b})}),children:[(0,ge.jsx)(z.Form.TextField,{title:"Title",...w.title}),(0,ge.jsx)(z.Form.TextArea,{title:"Details",...w.notes}),(0,ge.jsx)(z.Form.DatePicker,{title:"Due Date",...w.due}),(0,ge.jsx)(z.Form.Dropdown,{title:"Task List",...w.listId,children:l.map(d=>(0,ge.jsx)(z.Form.Dropdown.Item,{value:d.id,title:d.title},d.id))})]})}var oe=require("@raycast/api"),Jo=require("react"),Ye=require("react/jsx-runtime");function qn(a){let{pop:n}=(0,oe.useNavigation)(),o=(0,Jo.useCallback)(l=>{a.onEdit(a.listId,{...a.task,title:l.title,notes:l.notes,due:l.due}),n()},[a.onEdit,n]);return(0,Ye.jsxs)(oe.Form,{actions:(0,Ye.jsx)(oe.ActionPanel,{children:(0,Ye.jsx)(oe.Action.SubmitForm,{title:"Edit Task",icon:oe.Icon.Pencil,onSubmit:o})}),children:[(0,Ye.jsx)(oe.Form.TextField,{id:"title",title:"Title",defaultValue:a.task.title}),(0,Ye.jsx)(oe.Form.TextArea,{id:"notes",title:"Details",defaultValue:a.task.notes}),(0,Ye.jsx)(oe.Form.DatePicker,{id:"due",title:"Due Date",defaultValue:a.task.due===void 0?void 0:new Date(a.task.due)})]})}var Y=require("react/jsx-runtime");function jn(a){return(0,Y.jsx)(M.List.Item,{icon:zn(a.task),id:a.task.id,title:a.task.title,accessories:[{date:a.task.due===void 0?null:new Date(a.task.due)}],detail:(0,Y.jsx)(M.List.Item.Detail,{markdown:`# ${a.task.title}
      

${a.task.notes||""}`,metadata:(0,Y.jsxs)(M.List.Item.Detail.Metadata,{children:[(0,Y.jsx)(M.List.Item.Detail.Metadata.Label,{title:a.task.due===void 0?"":new Date(a.task.due).toLocaleDateString(),icon:M.Icon.Calendar}),(0,Y.jsx)(M.List.Item.Detail.Metadata.Separator,{}),jo(a.task,a.tasks).map(n=>(0,Y.jsx)(M.List.Item.Detail.Metadata.Label,{title:n.title,icon:zn(n)}))]})}),actions:(0,Y.jsxs)(M.ActionPanel,{children:[(0,Y.jsx)(M.Action,{title:"Complete Task",icon:M.Icon.CheckCircle,onAction:a.onToggle}),(0,Y.jsx)(M.Action,{title:"Delete Task",icon:M.Icon.Trash,style:M.Action.Style.Destructive,shortcut:{modifiers:["cmd"],key:"backspace"},onAction:a.onDelete}),(0,Y.jsx)(M.Action.Push,{title:"Create Task",icon:M.Icon.NewDocument,shortcut:{modifiers:["cmd"],key:"n"},target:(0,Y.jsx)(dt,{listId:a.listId,onCreate:a.onCreate})}),(0,Y.jsx)(M.Action.Push,{title:"Edit Task",icon:M.Icon.Pencil,shortcut:{modifiers:["cmd"],key:"e"},target:(0,Y.jsx)(qn,{listId:a.listId,task:a.task,onEdit:a.onEdit})})]})},a.task.id)}var se=require("@raycast/api");var X=require("react/jsx-runtime");function Nn(a){if(a.tasks.length>0)return(0,X.jsx)(se.List.EmptyView,{icon:"\u{1F4AC}",title:"No Matching Tasks",description:`Can't find a task matching ${a.searchText}.
Create it now!`,actions:(0,X.jsx)(se.ActionPanel,{children:(0,X.jsx)(se.Action.Push,{title:"Create Task",shortcut:{modifiers:["cmd"],key:"n"},target:(0,X.jsx)(dt,{listId:a.listId,title:a.searchText,onCreate:a.onCreate})})})});switch(a.filter){case"open":return(0,X.jsx)(se.List.EmptyView,{icon:"\u2705",title:"All Done",description:"All tasks complete!",actions:(0,X.jsx)(se.ActionPanel,{children:(0,X.jsx)(se.Action.Push,{title:"Create Task",shortcut:{modifiers:["cmd"],key:"n"},target:(0,X.jsx)(dt,{listId:a.listId,title:a.searchText,onCreate:a.onCreate})})})});case"completed":return(0,X.jsx)(se.List.EmptyView,{icon:"\u{1F622}",title:"No Tasks Completed",description:"No tasks complete."});case"all":default:return(0,X.jsx)(se.List.EmptyView,{icon:"\u{1F4DD}",title:"No Tasks Found",description:"You don't have any tasks yet.",actions:(0,X.jsx)(se.ActionPanel,{children:(0,X.jsx)(se.Action.Push,{title:"Create Task",shortcut:{modifiers:["cmd"],key:"n"},target:(0,X.jsx)(dt,{listId:a.listId,title:a.searchText,onCreate:a.onCreate})})})})}}var Le=require("react/jsx-runtime");function Vn(a){let[n,o]=(0,ke.useState)({filter:"open",isLoading:!0,searchText:"",tasks:[]});(0,ke.useEffect)(()=>{(async()=>{try{o(m=>({...m,isLoading:!0})),await lt();let d=n.filter==="all"||n.filter==="completed",f=await Pt(a.listId,d);o(m=>({...m,tasks:f,isLoading:!1}))}catch(d){console.error(d),o(f=>({...f,tasks:[],isLoading:!1})),(0,j.showToast)({style:j.Toast.Style.Failure,title:String(d)})}})()},[ct,n.filter]);let l=(0,ke.useCallback)((d,f)=>{(async()=>{try{o(E=>({...E,isLoading:!0})),await Vo(a.listId,f);let m=await Pt(a.listId);o(E=>({...E,tasks:m,isLoading:!1}))}catch(m){console.error(m),o(E=>({...E,tasks:[],isLoading:!1})),(0,j.showToast)({style:j.Toast.Style.Failure,title:String(m)})}})()},[n.tasks,o]),i=(0,ke.useCallback)((d,f)=>{(async()=>{try{o(E=>({...E,isLoading:!0})),await Ho(a.listId,f);let m=await Pt(a.listId);o(E=>({...E,tasks:m,isLoading:!1}))}catch(m){console.error(m),o(E=>({...E,tasks:[],isLoading:!1})),(0,j.showToast)({style:j.Toast.Style.Failure,title:String(m)})}})()},[n.tasks,o]),p=(0,ke.useCallback)(d=>{(async()=>{try{o(m=>({...m,isLoading:!0})),await Go(a.listId,d);let f=await Pt(a.listId);o(m=>({...m,tasks:f,isLoading:!1}))}catch(f){console.error(f),o(m=>({...m,tasks:[],isLoading:!1})),(0,j.showToast)({style:j.Toast.Style.Failure,title:String(f)})}})()},[n.tasks,o]),b=(0,ke.useCallback)(d=>{(async()=>{try{o(m=>({...m,isLoading:!0})),await No(a.listId,d.id);let f=await Pt(a.listId);o(m=>({...m,tasks:f,isLoading:!1}))}catch(f){console.error(f),o(m=>({...m,tasks:[],isLoading:!1})),(0,j.showToast)({style:j.Toast.Style.Failure,title:String(f)})}})()},[n.tasks,o]),w=(0,ke.useCallback)(()=>n.filter==="open"?n.tasks.filter(d=>!ft(d)):n.filter==="completed"?n.tasks.filter(d=>ft(d)):n.tasks,[n.tasks,n.filter]);return(0,Le.jsxs)(j.List,{isShowingDetail:!0,isLoading:n.isLoading,searchText:n.searchText,searchBarAccessory:(0,Le.jsxs)(j.List.Dropdown,{tooltip:"Filter Tasks...",value:n.filter,onChange:d=>o(f=>({...f,filter:d})),children:[(0,Le.jsx)(j.List.Dropdown.Item,{title:"All",value:"all"}),(0,Le.jsx)(j.List.Dropdown.Item,{title:"Open",value:"open"}),(0,Le.jsx)(j.List.Dropdown.Item,{title:"Completed",value:"completed"})]}),enableFiltering:!0,onSearchTextChange:d=>{o(f=>({...f,searchText:d}))},children:[w().map(d=>(0,Le.jsx)(jn,{listId:a.listId,tasks:n.tasks,task:d,onToggle:()=>p(d),onDelete:()=>b(d),onCreate:l,onEdit:i},d.id)),(0,Le.jsx)(Nn,{listId:a.listId,tasks:w(),filter:n.filter,searchText:n.searchText,onCreate:l})]})}var ht=require("react/jsx-runtime");function Xo(){let[a,n]=(0,Zt.useState)(!0),[o,l]=(0,Zt.useState)([]);return(0,Zt.useEffect)(()=>{(async()=>{try{await lt();let i=await Ur();l(i),n(!1)}catch(i){console.error(i),n(!1),(0,Q.showToast)({style:Q.Toast.Style.Failure,title:String(i)})}})()},[ct]),a?(0,ht.jsx)(Q.Detail,{isLoading:a}):(0,ht.jsx)(Q.List,{isLoading:a,children:o.map(i=>(0,ht.jsx)(Q.List.Item,{id:i.id,title:i.title,actions:(0,ht.jsx)(Q.ActionPanel,{children:(0,ht.jsx)(Q.Action.Push,{title:"Show List",icon:Q.Icon.List,target:(0,ht.jsx)(Vn,{listId:i.id})})})},i.id))})}
/*! Bundled license information:

web-streams-polyfill/dist/ponyfill.es2018.js:
  (**
   * @license
   * web-streams-polyfill v3.3.3
   * Copyright 2024 Mattias Buelens, Diwank Singh Tomer and other contributors.
   * This code is released under the MIT license.
   * SPDX-License-Identifier: MIT
   *)

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)
*/
