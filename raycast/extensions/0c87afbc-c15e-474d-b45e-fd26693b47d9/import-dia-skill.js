"use strict";var m=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var u=Object.prototype.hasOwnProperty;var S=(a,e)=>{for(var r in e)m(a,r,{get:e[r],enumerable:!0})},x=(a,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of w(e))!u.call(a,i)&&i!==r&&m(a,i,{get:()=>e[i],enumerable:!(o=y(e,i))||o.enumerable});return a};var v=a=>x(m({},"__esModule",{value:!0}),a);var k={};S(k,{default:()=>d});module.exports=v(k);var t=require("@raycast/api"),g=require("url"),n=(a,e)=>a.match(e)?.[1]?.trim()??"";async function d(a){let{skillUrl:e}=a.arguments;if(!e){await(0,t.showToast)({style:t.Toast.Style.Failure,title:"Missing URL",message:"Please provide a valid Dia skill URL"});return}if(!e.startsWith("https://www.diabrowser.com/skills/")){await(0,t.showToast)({style:t.Toast.Style.Failure,title:"Invalid URL",message:"Please provide a valid URL from diabrowser.com/skills"});return}await(0,t.showToast)({style:t.Toast.Style.Animated,title:"Importing Skill..."});try{let r=await fetch(e);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);let o=await r.text(),i=n(o,/<h1[^>]*>([^<]+)<\/h1>/);if(!i){let l=n(o,/<title>([^<]+)<\/title>/);l&&(i=l.split(" | ")[0].trim())}if(i||(i=n(o,/<meta property="og:title" content="([^"]+)"/)),!i)throw new Error("Could not find skill name.");let s="",c=o.match(/<div class="bg-fill-tertiary rounded-8 p-12"><div class="rich-text[^"]*"[^>]*>([\s\S]*?)<\/div><\/div>/);if(c&&c[1]&&(s=c[1].replace(/<\/p>/g,`

`).replace(/<\/li>/g,`
`).replace(/<[^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/\n\s*\n\s*\n/g,`

`).trim()),s||(s=n(o,/<textarea[^>]*>([\s\S]*?)<\/textarea>/)),!s){let l=o.match(/<meta name="description" content="([^"]+)"/);if(l&&l[1])s=l[1];else throw new Error("Could not find prompt text.")}s=`@browser find relevant tabs and get their content (only if necessary) for the following:

`+s,s=s.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").trim();let p=(0,t.getPreferenceValues)(),h={title:i,prompt:s,model:p.model||"raycast-ray1",icon:p.icon||"link",creativity:p.creativity||"medium",highlightEdits:!1},f=`https://ray.so/prompts/shared?${new g.URLSearchParams({prompts:JSON.stringify(h)}).toString()}`;await(0,t.open)(f),await(0,t.showToast)({style:t.Toast.Style.Success,title:"Successfully Imported Skill",message:`Opened "${i}" in ray.so`}),await(0,t.closeMainWindow)(),await(0,t.popToRoot)()}catch(r){await(0,t.showToast)({style:t.Toast.Style.Failure,title:"Failed to Import Skill",message:r instanceof Error?r.message:String(r)})}}
